<!DOCTYPE html>
<html>

<!-- Mirrored from www.learnrazorpages.com/razor-pages/ajax/upload-files by HTTrack Website Copier/3.x [XR&CO'2005], Fri, 07 Jun 2019 04:18:00 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <meta name="google-site-verification" content="MpV6gEoCh9OASgnoi656klwnlkni3_qOenITGlxBrjc" />
    <title>Uploading Files via AJAX in Razor Pages | Learn Razor Pages</title>
    <link rel="canonical" href="upload-files.html" />
    <link rel="stylesheet" href="../../../ajax.aspnetcdn.com/ajax/bootstrap/3.3.6/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,600,600i|Roboto:300i,500,700" />
    <link rel="stylesheet" href="../../../use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
    <script src="../../../cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
    <link rel="stylesheet" href="../../css/site8249.css?v=PCA7f9VuZUscxMwrePJfyFKXCF9mh2dMpXEDQU8oP3o" />
    <link rel="stylesheet" href="../../css/rp14c5.css?v=ZxkVB0StHjR5-UMElJII7nwWe6Wmc6_qgJ97GsY4yNw" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <script async src="../../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
        <script>
            (adsbygoogle = window.adsbygoogle || []).push({
                google_ad_client: "ca-pub-8046723421340367",
                enable_page_level_ads: true
            });
        </script>
</head>
<body id="page-top">
    <div class="navbar navbar-default navbar-static-top">
        <div>
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <div class="navbar-brand">
                    <i class="fas fa-graduation-cap"></i> <a href="../../index.html">Learn Razor Pages</a>
                    <br />
                    <span class="byline">Your guide to using ASP.NET Core Razor Pages</span>
                </div>
                <div class="banner">
                    
                        <script async src="../../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
                        <!-- EF Core Leaderboard -->
                        <ins class="adsbygoogle"
                             style="display:inline-block;width:728px;height:90px"
                             data-ad-client="ca-pub-8046723421340367"
                             data-ad-slot="1832525889"></ins>
                        <script>
                        (adsbygoogle = window.adsbygoogle || []).push({});
                        </script>                    
                </div>
            </div>

        </div>
    </div>
    <div class="navbar-default sidebar" role="navigation">
        <div class="sidebar-nav navbar-collapse">
            <nav class="main-nav" itemscope itemtype="http://schema.org/SiteNavigationElement">
    <ul class="nav nav-level-one" id="side-menu">
        <li>
            <a itemprop="url" href="../../index.html">Home</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="../../first-look.html">A First Look</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../../asp-net-core.html">ASP.NET Core</a>
        </li>
        <li><a itemprop="url" href="../tutorial/bakery.html">Tutorials</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="../tutorial/bakery.html">The Bakery</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../../razor-pages.html">Razor Page Files</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="../files/index.html">Razor Files</a></li>
                <li><a itemprop="url" href="../partial-pages.html">Partial Pages</a></li>
                <li><a itemprop="url" href="../files/layout.html">Layout Files</a></li>
                <li><a itemprop="url" href="../files/viewimports.html">ViewImports File</a></li>
                <li><a itemprop="url" href="../files/viewstart.html">ViewStart File</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../../razor-syntax.html">Razor Syntax</a>
        </li>
        <li>
            <a itemprop="url" href="../pagemodel.html">Page Models</a>
            <ul class="nav-level-two">
                <li>
                    <a itemprop="url" href="../handler-methods.html">Handler Methods</a>
                </li>
                <li>
                    <a itemprop="url" href="../viewdata.html">ViewData</a>
                </li>
                <li>
                    <a itemprop="url" href="../action-results.html">Action Results</a>
                </li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../tag-helpers/index.html">Tag Helpers</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="../tag-helpers/anchor-tag-helper.html">Anchor Tag Helper</a></li>
                <li><a itemprop="url" href="../tag-helpers/cache-tag-helper.html">Cache Tag Helper</a></li>
                <li><a itemprop="url" href="../tag-helpers/distributed-cache-tag-helper.html">Distributed Cache Tag Helper</a></li>
                <li><a itemprop="url" href="../tag-helpers/environment-tag-helper.html">Environment Tag Helper</a></li>
                <li><a itemprop="url" href="../tag-helpers/form-action-tag-helper.html">Form Action Tag Helper</a></li>
                <li><a itemprop="url" href="../tag-helpers/form-tag-helper.html">Form Tag Helper</a></li>
                <li><a itemprop="url" href="../tag-helpers/image-tag-helper.html">Image Tag Helper</a></li>
                <li><a itemprop="url" href="../tag-helpers/input-tag-helper.html">Input Tag Helper</a></li>
                <li><a itemprop="url" href="../tag-helpers/label-tag-helper.html">Label Tag Helper</a></li>
                <li><a itemprop="url" href="../tag-helpers/link-tag-helper.html">Link Tag Helper</a></li>
                <li><a itemprop="url" href="../tag-helpers/option-tag-helper.html">Option Tag Helper</a></li>
                <li><a itemprop="url" href="../tag-helpers/partial-tag-helper.html">Partial Tag Helper</a></li>
                <li><a itemprop="url" href="../tag-helpers/script-tag-helper.html">Script Tag Helper</a></li>
                <li><a itemprop="url" href="../tag-helpers/select-tag-helper.html">Select Tag Helper</a></li>
                <li><a itemprop="url" href="../tag-helpers/textarea-tag-helper.html">TextArea Tag Helper</a></li>
                <li><a itemprop="url" href="../tag-helpers/validation-message-tag-helper.html">Validation Message Tag Helper</a></li>
                <li><a itemprop="url" href="../tag-helpers/validation-summary-tag-helper.html">Validation Summary Tag Helper</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../view-components.html">View Components</a>
        </li>
        <li>
            <a itemprop="url" href="../routing.html">Routing and URLs</a>
            <ul class="nav-level-two">
                <li><a href="../../advanced/custom-route-conventions.html">Customising Route Conventions</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../../startup.html">Startup</a>
        </li>
        <li>
            <a itemprop="url" href="../../configuration.html">Configuration</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="../../configuration/global-error-handling.html">Global Error Handling And Logging</a></li>
                <li><a itemprop="url" href="../../configuration/custom-errors.html">Custom Error Pages</a></li>
                <li><a itemprop="url" href="../../configuration/https.html">Configuring HTTPS</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../../middleware.html">Middleware</a>
        </li>
        <li>
            <a itemprop="url" href="../forms.html">Working With Forms</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="../forms/file-upload.html">Uploading Files in Razor Pages</a></li>
                <li><a itemprop="url" href="../forms/checkboxes.html">Working With Checkboxes</a></li>
                <li><a itemprop="url" href="../forms/select-lists.html">Select Lists in a Razor Pages Form</a></li>
                <li><a itemprop="url" href="../forms/radios.html">Working With Radio Buttons</a></li>
                <li><a itemprop="url" href="../../security/request-verification.html">Request Verification</a></li>
            </ul>
        </li>
        <li><a itemprop="url" href="../validation.html">Validation</a></li>
        <li>
            <a itemprop="url" href="../model-binding.html">Model Binding</a>
        </li>
        <li>
            <a itemprop="url" href="../state-management.html">State Management</a>
        </li>
        <li>
            <a itemprop="url" href="../caching.html">Caching</a>
        </li>
        <li>
            <a itemprop="url" href="../../identity.html">Managing Security With ASP.NET Identity</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="../../identity/customising-identity.html">Customising Identity</a></li>
            </ul>
        </li>
        <li>
		<a itemprop="url" href="../ajax.html">Using AJAX</a>
		<ul class="nav-level-two">
			<li><a itemprop="url" href="form-post.html">Posting Forms</a>    </li>
			<li><a itemprop="url" href="partial-update.html">Partial Page Updates</a></li>
			<li><a itemprop="url" href="upload-files.html">Uploading Files</a></li>
			<li><a itemprop="url" href="unobtrusive-ajax.html">Unobtrusive AJAX</a></li>
		</ul>
	</li>
        <li>
            <a itemprop="url" href="../../web-api.html">Working with JSON</a>
        </li>
        <li>
            <a itemprop="url" href="../../miscellaneous/scaffolding.html">Scaffolding</a>
        </li>
        <li>
            <a itemprop="url" href="../../publishing/publish-to-iis.html">Publishing To IIS</a>
        </li>
        <li>
            <a itemprop="url" href="../../advanced.html">Advanced</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="../../advanced/areas.html">Areas</a></li>
                <li><a itemprop="url" href="../../advanced/custom-tag-helpers.html">Custom Tag Helpers</a></li>
                <li><a itemprop="url" href="../../advanced/custom-route-conventions.html">Customising Route Conventions</a></li>
                <li><a itemprop="url" href="../../advanced/custom-constraints.html">Custom Route Constraints</a></li>
                <li><a itemprop="url" href="../../advanced/route-parameter-transformers.html">Parameter Transformers For Routes</a></li>
                <li><a itemprop="url" href="../../advanced/dependency-injection.html">Dependency Injection</a></li>
                <li><a itemprop="url" href="../filters.html">Filters</a></li>
                <li><a itemprop="url" href="../../advanced/razor-class-library.html">Razor Class Libraries</a></li>
                <li><a itemprop="url" href="../../advanced/render-partial-to-string.html">Rendering A Partial View To A String</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../../table-of-contents.html">Table Of Contents</a>
        </li>
    </ul>
</nav>

            <footer>
                <p>&copy; 2019 - Learn Razor Pages.<br />All rights reserved.</p>
            </footer>
        </div>
        <!-- /.sidebar-collapse -->
    </div>

    <div id="page-wrapper">
        <div class="body-content">
            <div class="row">
                <div class="col-md-9">
                    
<div id="article">
    <h1 itemprop="headline" id="uploading-files-via-ajax-in-razor-pages">Uploading Files via AJAX in Razor Pages</h1>
<div itemprop="articleBody"><p>AJAX is a technique used for making asynchronous requests from the browser to the server for various purposes including posting form values. This section covers asynchronous form submission from a Razor Page using both the jQuery AJAX capability and the Fetch API.</p>
<h2 id="the-razor-page">The Razor Page</h2>
<p>The PageModel for this example includes a property called <code>UploadedFile</code>, which represents the file that gets uploaded when the form is posted. The <code>IFormFile</code> type is located in the <code>Microsoft.AspNetCore.Http</code> namespace:</p>
<pre><code class="language-csharp">public class IndexModel : PageModel
{
    [BindProperty, Display(Name=&quot;File&quot;)]
    public IFormFile UploadedFile { get; set; }

    public void OnPost()
    {

    }
}


</code></pre>
<p>The <code>UploadedFile</code> property make use of attributes to control the output of tag helpers, specifically the label and input tag helpers.</p>
<p>Here is the content page, styled using BootStrap 4:</p>
<pre><code class="language-html">&lt;form method=&quot;post&quot; class=&quot;col-sm-6&quot;&gt;
    &lt;div class=&quot;form-group row&quot;&gt;
        &lt;label asp-for=&quot;UploadedFile&quot; class=&quot;col-sm-3 col-form-label&quot;&gt;&lt;/label&gt;
        &lt;div class=&quot;col-sm-7&quot;&gt;
            &lt;input asp-for=&quot;UploadedFile&quot; class=&quot;form-control&quot;&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class=&quot;form-group row&quot;&gt;
        
        &lt;div class=&quot;col-sm-7 offset-sm-3&quot;&gt;
            &lt;button class=&quot;btn btn-primary&quot; id=&quot;submit&quot;&gt;Submit&lt;/button&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/form&gt;
</code></pre>
<p>The input tag helper automatically ensures that the <code>type</code> property on the input is rendered as <code>file</code>, based on the data type of the property passed to the <code>asp-for</code> attribute.</p>
<p><img src="../../images/18-09-2018-14-08-53.png" class="img-fluid" alt="AJAX File Upload in Razor Pages" /></p>
<h2 id="using-jquery">Using jQuery</h2>
<p>The first example looks at using jQuery to post the form content asynchronously. The actual script is included using a Razor section, but can just as easily be included in a separate file:</p>
<pre><code class="language-html">@section scripts{ 
&lt;script&gt;
    $(function () {
        $('#submit').on('click', function (evt) {
            evt.preventDefault();
            $.ajax({
                url: '',
                data: new FormData(document.forms[0]),
                contentType: false,
                processData: false,
                type: 'post',
                success: function () {
                    alert('Uploaded by jQuery');
                }
            });
        });
    });
&lt;/script&gt;
}
</code></pre>
<p>The jQuery library includes a number of wrapper functions that result in a minimal amount of code required to make an AJAX request e.g. <code>$.post</code>, <code>$.get</code>. However, for uploading files, the full <code>$.ajax</code> version is needed because some settings need to be changed. The <code>contenttype</code> needs to be set to <code>false</code> along with the <code>processData</code> option. Otherwise jQuery will not see this as a file upload, and will set the encoding of the request body to <code>application/x-www-form-urlencoded</code>, which is fine for simple text, but not for files.</p>
<p>When the form is posted, the file is automatically bound to the <code>IFormFile</code> property on the PageModel:</p>
<p><img src="../../images/18-09-2018-14-09-44.png" class="img-fluid" alt="Upload Files using AJAX" /></p>
<h2 id="using-fetch">Using Fetch</h2>
<p>The Fetch API is supported by all modern browsers except Internet Explorer. It is supported by the new Edge browser from Microsoft, which is available on Windows 10. This example makes no use of the jQuery library at all, relying on pure JavaScript:</p>
<pre><code class="language-html">@section scripts{ 
&lt;script&gt;
    document.getElementById('submit').addEventListener(&quot;click&quot;, (evt) =&gt; {
        evt.preventDefault();
        let data = new FormData(document.forms[0]);
        fetch('', {
            method: 'post',
            body: data 
        })
        .then(() =&gt; {
            alert('Posted using Fetch');
        });
    });
&lt;/script&gt;
}
</code></pre>
<p>This example uses the <a href="https://developer.mozilla.org/en-US/docs/Web/API/FormData">FormData API</a> to construct a set of key/value pairs representing the form fields and their values. The FormData constructor will accepts an HTML <code>form</code> element and then use the name property of each element in the form for the keys and their submitted value for the values.</p>
<p>When using FormData, the encoding type of the request body defaults to <code>multipart/form-data</code>, which is the correct encoding for posting binary data.</p>
<h2 id="using-xmlhttprequest">Using XMLHttpRequest</h2>
<p>Finally, this is how it is achieved using the XMLHttpRequest object:</p>
<pre><code class="language-html">section scripts{ 
&lt;script&gt;
    document.forms[0].onsubmit = () =&gt; {
        let formData = new FormData(document.forms[0]);
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function() {
            if (this.readyState === 4 &amp;&amp; this.status === 200) {
                alert('Posted using XMLHttpRequest');
            }
        };
        xhr.open('post', '', true);
        xhr.send(formData);
        return false;
    };
&lt;/script&gt;
}
</code></pre>
<h4 id="further-reading">Further reading</h4>
<ul>
<li><a href="form-post.html">Posting Forms with AJAX in Razor Pages</a></li>
<li><a href="unobtrusive-ajax.html">Unobtrusive AJAX</a></li>
</ul>

</div>
</div>
<section id="file-meta">
    <span class="file-meta-label">Last updated:</span> <span itemprop="dateModified">08/05/2019 14:29:05</span><br />
</section>

                </div>
                <div class="col-md-3 right-col">
                    
                            <script>
                        (function() {
                            var cx = 'partner-pub-8046723421340367:6108194070';
                            var gcse = document.createElement('script');
                            gcse.type = 'text/javascript';
                            gcse.async = true;
                            gcse.src = '../../../cse.google.com/cse07b6.html?cx=' + cx;
                            var s = document.getElementsByTagName('script')[0];
                            s.parentNode.insertBefore(gcse, s);
                        })();
                            </script>
                        <gcse:searchbox-only></gcse:searchbox-only>
                    
                    <div id="doc-outline" class="doc-outline well">
                            <h3 class="doc-outline">On this page</h3>
                            <nav class="doc-outline">
                                <ul>
                                        <li><a itemprop="url" href="#uploading-files-via-ajax-in-razor-pages" class="page-scroll">Uploading Files via AJAX in Razor Pages</a></li>
                                        <li><a itemprop="url" href="#the-razor-page" class="page-scroll">The Razor Page</a></li>
                                        <li><a itemprop="url" href="#using-jquery" class="page-scroll">Using jQuery</a></li>
                                        <li><a itemprop="url" href="#using-fetch" class="page-scroll">Using Fetch</a></li>
                                        <li><a itemprop="url" href="#using-xmlhttprequest" class="page-scroll">Using XMLHttpRequest</a></li>
                                </ul>
                            </nav>

                    </div>
                    <div class="rectangle">
                        
                                <script async src="../../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
                            <!-- EF Core Rectangle -->
                            <ins class="adsbygoogle"
                                 style="display:inline-block;width:300px;height:250px"
                                 data-ad-client="ca-pub-8046723421340367"
                                 data-ad-slot="7622896857"></ins>
                            <script>
                                (adsbygoogle = window.adsbygoogle || []).push({});
                            </script>
                        
                    </div>
                    <div class="doc-outline well">
                        <h3 class="doc-outline">Latest Updates</h3>
                        <nav class="doc-outline">
                            <ul>
                                    <li><a itemprop="url" href="../tutorial/bakery/migration.html">Creating A Migration</a></li>
                                    <li><a itemprop="url" href="../tutorial/bakery/create-model.html">Working With A Model</a></li>
                                    <li><a itemprop="url" href="../routing.html">Routing in Razor Pages</a></li>
                                    <li><a itemprop="url" href="../tutorial/bakery/working-with-data.html">Working With Data</a></li>
                                    <li><a itemprop="url" href="../tutorial/bakery/new-page.html">Adding a New Page</a></li>
                                    <li><a itemprop="url" href="../tutorial/bakery.html">Creating an Application</a></li>
                            </ul>
                        </nav>
                    </div>
                    <div class="skyscraper">
                        
                                <script async src="../../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
                            <!-- EF Core Skyscraper -->
                            <ins class="adsbygoogle"
                                 style="display:inline-block;width:300px;height:600px"
                                 data-ad-client="ca-pub-8046723421340367"
                                 data-ad-slot="4239197376"></ins>
                            <script>
                                (adsbygoogle = window.adsbygoogle || []).push({});
                            </script>
                        
                    </div>
                    <footer>
                        <p>&copy; 2019 - Learn Razor Pages.<br />All rights reserved.</p>
                    </footer>
                </div>
            </div>
        </div>
        <a href="#page-top" id="back-to-top" class="page-scroll" title="Back to top"><i class="fas fa-arrow-alt-circle-up"></i></a>
    </div>
    <div class="cookie-box" id="cookie-warning">
        <div class="cookie-box-contents" id="learnrazorpages">This site uses cookies to analyse traffic, remember your preferences, and optimise your experience.</div>
        <div class="cookie-box-buttons"><a href="../../privacy.html" class="cookie-button">Learn more</a><a href="#" class="cookie-button" id="cookie-close">Close</a></div>
    </div>
    <script src="../../../ajax.aspnetcdn.com/ajax/jquery/jquery-2.2.0.min.js"></script>
    <script src="../../../ajax.aspnetcdn.com/ajax/bootstrap/3.3.6/bootstrap.min.js"></script>
    <script src="../../../code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    
    <script src="../../../cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
    <script src="../../js/site59f2.js?v=gJZRD7PDF8oEm1Xb0uhLZcpf7Vs12fGO-q0DErBSF_Y"></script>
    
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-1264020-21"></script>
        <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-1264020-21');
        </script>
    
    
</body>

<!-- Mirrored from www.learnrazorpages.com/razor-pages/ajax/upload-files by HTTrack Website Copier/3.x [XR&CO'2005], Fri, 07 Jun 2019 04:18:00 GMT -->
</html>
