<!DOCTYPE html>
<html>

<!-- Mirrored from www.learnrazorpages.com/razor-pages/tempdata by HTTrack Website Copier/3.x [XR&CO'2005], Fri, 07 Jun 2019 04:24:48 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="TempData is a storage container for data that needs to be available to a separate HTTP request." />
    <meta name="google-site-verification" content="MpV6gEoCh9OASgnoi656klwnlkni3_qOenITGlxBrjc" />
    <title>TempData In Razor Pages | Learn Razor Pages</title>
    <link rel="canonical" href="tempdata.html" />
    <link rel="stylesheet" href="../../ajax.aspnetcdn.com/ajax/bootstrap/3.3.6/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,600,600i|Roboto:300i,500,700" />
    <link rel="stylesheet" href="../../use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
    <script src="../../cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
    <link rel="stylesheet" href="../css/site8249.css?v=PCA7f9VuZUscxMwrePJfyFKXCF9mh2dMpXEDQU8oP3o" />
    <link rel="stylesheet" href="../css/rp14c5.css?v=ZxkVB0StHjR5-UMElJII7nwWe6Wmc6_qgJ97GsY4yNw" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <script async src="../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
        <script>
            (adsbygoogle = window.adsbygoogle || []).push({
                google_ad_client: "ca-pub-8046723421340367",
                enable_page_level_ads: true
            });
        </script>
</head>
<body id="page-top">
    <div class="navbar navbar-default navbar-static-top">
        <div>
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <div class="navbar-brand">
                    <i class="fas fa-graduation-cap"></i> <a href="../index.html">Learn Razor Pages</a>
                    <br />
                    <span class="byline">Your guide to using ASP.NET Core Razor Pages</span>
                </div>
                <div class="banner">
                    
                        <script async src="../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
                        <!-- EF Core Leaderboard -->
                        <ins class="adsbygoogle"
                             style="display:inline-block;width:728px;height:90px"
                             data-ad-client="ca-pub-8046723421340367"
                             data-ad-slot="1832525889"></ins>
                        <script>
                        (adsbygoogle = window.adsbygoogle || []).push({});
                        </script>                    
                </div>
            </div>

        </div>
    </div>
    <div class="navbar-default sidebar" role="navigation">
        <div class="sidebar-nav navbar-collapse">
            <nav class="main-nav" itemscope itemtype="http://schema.org/SiteNavigationElement">
    <ul class="nav nav-level-one" id="side-menu">
        <li>
            <a itemprop="url" href="../index.html">Home</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="../first-look.html">A First Look</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../asp-net-core.html">ASP.NET Core</a>
        </li>
        <li><a itemprop="url" href="tutorial/bakery.html">Tutorials</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="tutorial/bakery.html">The Bakery</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../razor-pages.html">Razor Page Files</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="files/index.html">Razor Files</a></li>
                <li><a itemprop="url" href="partial-pages.html">Partial Pages</a></li>
                <li><a itemprop="url" href="files/layout.html">Layout Files</a></li>
                <li><a itemprop="url" href="files/viewimports.html">ViewImports File</a></li>
                <li><a itemprop="url" href="files/viewstart.html">ViewStart File</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../razor-syntax.html">Razor Syntax</a>
        </li>
        <li>
            <a itemprop="url" href="pagemodel.html">Page Models</a>
            <ul class="nav-level-two">
                <li>
                    <a itemprop="url" href="handler-methods.html">Handler Methods</a>
                </li>
                <li>
                    <a itemprop="url" href="viewdata.html">ViewData</a>
                </li>
                <li>
                    <a itemprop="url" href="action-results.html">Action Results</a>
                </li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="tag-helpers/index.html">Tag Helpers</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="tag-helpers/anchor-tag-helper.html">Anchor Tag Helper</a></li>
                <li><a itemprop="url" href="tag-helpers/cache-tag-helper.html">Cache Tag Helper</a></li>
                <li><a itemprop="url" href="tag-helpers/distributed-cache-tag-helper.html">Distributed Cache Tag Helper</a></li>
                <li><a itemprop="url" href="tag-helpers/environment-tag-helper.html">Environment Tag Helper</a></li>
                <li><a itemprop="url" href="tag-helpers/form-action-tag-helper.html">Form Action Tag Helper</a></li>
                <li><a itemprop="url" href="tag-helpers/form-tag-helper.html">Form Tag Helper</a></li>
                <li><a itemprop="url" href="tag-helpers/image-tag-helper.html">Image Tag Helper</a></li>
                <li><a itemprop="url" href="tag-helpers/input-tag-helper.html">Input Tag Helper</a></li>
                <li><a itemprop="url" href="tag-helpers/label-tag-helper.html">Label Tag Helper</a></li>
                <li><a itemprop="url" href="tag-helpers/link-tag-helper.html">Link Tag Helper</a></li>
                <li><a itemprop="url" href="tag-helpers/option-tag-helper.html">Option Tag Helper</a></li>
                <li><a itemprop="url" href="tag-helpers/partial-tag-helper.html">Partial Tag Helper</a></li>
                <li><a itemprop="url" href="tag-helpers/script-tag-helper.html">Script Tag Helper</a></li>
                <li><a itemprop="url" href="tag-helpers/select-tag-helper.html">Select Tag Helper</a></li>
                <li><a itemprop="url" href="tag-helpers/textarea-tag-helper.html">TextArea Tag Helper</a></li>
                <li><a itemprop="url" href="tag-helpers/validation-message-tag-helper.html">Validation Message Tag Helper</a></li>
                <li><a itemprop="url" href="tag-helpers/validation-summary-tag-helper.html">Validation Summary Tag Helper</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="view-components.html">View Components</a>
        </li>
        <li>
            <a itemprop="url" href="routing.html">Routing and URLs</a>
            <ul class="nav-level-two">
                <li><a href="../advanced/custom-route-conventions.html">Customising Route Conventions</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../startup.html">Startup</a>
        </li>
        <li>
            <a itemprop="url" href="../configuration.html">Configuration</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="../configuration/global-error-handling.html">Global Error Handling And Logging</a></li>
                <li><a itemprop="url" href="../configuration/custom-errors.html">Custom Error Pages</a></li>
                <li><a itemprop="url" href="../configuration/https.html">Configuring HTTPS</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../middleware.html">Middleware</a>
        </li>
        <li>
            <a itemprop="url" href="forms.html">Working With Forms</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="forms/file-upload.html">Uploading Files in Razor Pages</a></li>
                <li><a itemprop="url" href="forms/checkboxes.html">Working With Checkboxes</a></li>
                <li><a itemprop="url" href="forms/select-lists.html">Select Lists in a Razor Pages Form</a></li>
                <li><a itemprop="url" href="forms/radios.html">Working With Radio Buttons</a></li>
                <li><a itemprop="url" href="../security/request-verification.html">Request Verification</a></li>
            </ul>
        </li>
        <li><a itemprop="url" href="validation.html">Validation</a></li>
        <li>
            <a itemprop="url" href="model-binding.html">Model Binding</a>
        </li>
        <li>
            <a itemprop="url" href="state-management.html">State Management</a>
        </li>
        <li>
            <a itemprop="url" href="caching.html">Caching</a>
        </li>
        <li>
            <a itemprop="url" href="../identity.html">Managing Security With ASP.NET Identity</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="../identity/customising-identity.html">Customising Identity</a></li>
            </ul>
        </li>
        <li>
		<a itemprop="url" href="ajax.html">Using AJAX</a>
		<ul class="nav-level-two">
			<li><a itemprop="url" href="ajax/form-post.html">Posting Forms</a>    </li>
			<li><a itemprop="url" href="ajax/partial-update.html">Partial Page Updates</a></li>
			<li><a itemprop="url" href="ajax/upload-files.html">Uploading Files</a></li>
			<li><a itemprop="url" href="ajax/unobtrusive-ajax.html">Unobtrusive AJAX</a></li>
		</ul>
	</li>
        <li>
            <a itemprop="url" href="../web-api.html">Working with JSON</a>
        </li>
        <li>
            <a itemprop="url" href="../miscellaneous/scaffolding.html">Scaffolding</a>
        </li>
        <li>
            <a itemprop="url" href="../publishing/publish-to-iis.html">Publishing To IIS</a>
        </li>
        <li>
            <a itemprop="url" href="../advanced.html">Advanced</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="../advanced/areas.html">Areas</a></li>
                <li><a itemprop="url" href="../advanced/custom-tag-helpers.html">Custom Tag Helpers</a></li>
                <li><a itemprop="url" href="../advanced/custom-route-conventions.html">Customising Route Conventions</a></li>
                <li><a itemprop="url" href="../advanced/custom-constraints.html">Custom Route Constraints</a></li>
                <li><a itemprop="url" href="../advanced/route-parameter-transformers.html">Parameter Transformers For Routes</a></li>
                <li><a itemprop="url" href="../advanced/dependency-injection.html">Dependency Injection</a></li>
                <li><a itemprop="url" href="filters.html">Filters</a></li>
                <li><a itemprop="url" href="../advanced/razor-class-library.html">Razor Class Libraries</a></li>
                <li><a itemprop="url" href="../advanced/render-partial-to-string.html">Rendering A Partial View To A String</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../table-of-contents.html">Table Of Contents</a>
        </li>
    </ul>
</nav>

            <footer>
                <p>&copy; 2019 - Learn Razor Pages.<br />All rights reserved.</p>
            </footer>
        </div>
        <!-- /.sidebar-collapse -->
    </div>

    <div id="page-wrapper">
        <div class="body-content">
            <div class="row">
                <div class="col-md-9">
                    
<div id="article">
    <h1 itemprop="headline" id="tempdata-in-razor-pages">TempData In Razor Pages</h1>
<div itemprop="articleBody"><p>TempData is a storage container for data that needs to be available to a separate HTTP request. The canonical example for illustrating how TempData works involves providing feedback to the user after a form submission that results in the user being redirected to another page (Post-Redirect-Get).</p>
<p>Here is a very simple form:</p>
<pre><code class="language-html">&lt;form method=&quot;post&quot;&gt;
    &lt;input type=&quot;text&quot; asp-for=&quot;EmailAddress&quot;/&gt;
    &lt;span asp-validation-for=&quot;EmailAddress&quot;&gt;&lt;/span&gt;&lt;br/&gt;
    &lt;button&gt;Submit&lt;/button&gt;
&lt;/form&gt;
</code></pre>
<p>In the following code snippet, a PageModel property called <code>FormResult</code> has been decorated with the <code>TempData</code> attribute.</p>
<pre><code class="language-csharp">public class IndexModel : PageModel
{
    [TempData]
    public string FormResult { get; set; }
    [BindProperty]
    public string EmailAddress { get; set; }
    // ...
</code></pre>
<p>The property has a value assigned to it when the form is posted.</p>
<pre><code class="language-csharp">public IActionResult OnPost()
{
    try
    {
        var email = new MailAddress(EmailAddress);
        FormResult = &quot;You have provided a valid email address&quot;;
        return RedirectToPage(&quot;/success&quot;);
    }
    catch(FormatException)
    {
        ModelState.AddModelError(&quot;EmailAddress&quot;, &quot;Invalid email address&quot;);
        return Page();
    }
}
</code></pre>
<p>If the validation test passes, the user is redirected to another page (<em>success.cshtml</em>). There, the TempData value is accessed using a string indexer:</p>
<pre><code class="language-html">&lt;h4&gt;@TempData[&quot;FormResult&quot;]&lt;/h4&gt;
</code></pre>
<div class="alert alert-info"><p>In ASP.NET Core 2.0 (and earlier versions if you are using MVC), the index value is prefixed with &quot;TempDataProperty-&quot;, so you would have to use the following code to access the value:</p>
<pre><code class="language-html">&lt;h4&gt;@TempData[&quot;TempDataProperty-FormResult&quot;]&lt;/h4&gt;
</code></pre>
<p>If you want to change this behaviour in ASP.NET Core 2.0, you can use the <code>MvcOptions</code> to change the default behaviour:</p>
<pre><code class="language-csharp">services.AddMvc().AddViewOptions(options =&gt;
{
    options.SuppressTempDataAttributePrefix = true; 
});
</code></pre>
</div>
<p>Once the value has been read, it is marked for deletion and is therefore not available for subsequent requests.</p>
<h2 id="retaining-tempdata-values">Retaining TempData Values</h2>
<p>If you want to access a TempData value and then retain it for a further request, you have two options. The first is the <code>Peek</code> method, which allows you to read a value without it being marked for deletion:</p>
<pre><code class="language-csharp">var temp = TempData.Peek(&quot;FormResult&quot;);
</code></pre>
<p>The second option is to use the <code>Keep</code> method after you have accessed the value. This has the effect of marking the value for retention. The <code>Keep</code> method provides two options. You can either specify that the whole dictionary is retained:</p>
<pre><code class="language-csharp">var result = TempData[&quot;FormResult&quot;];
TempData.Keep();
</code></pre>
<p>Or you can just mark individual values for retention:</p>
<pre><code class="language-csharp">var result = TempData[&quot;FormResult&quot;];
TempData.Keep(&quot;FormResult&quot;)
</code></pre>
<h2 id="storage-mechanisms">Storage Mechanisms</h2>
<p>The default storage mechanism for TempData is cookies, which is enabled by default in a typical Razor Pages application.</p>
<p><img src="../images/18-04-2018-08-08-44.png" class="img-fluid" alt="TempData cookie" /></p>
<p>Alternatively, you can use <a href="session-state.html">Session State</a>.</p>
<h3 id="cookie-configuration">Cookie Configuration</h3>
<p>You can configure various options related to the TempData cookie in the <code>ConfigureServices</code> method. The following example changes the name of the cookie:</p>
<pre><code class="language-csharp">services.Configure&lt;CookieTempDataProviderOptions&gt;(options =&gt;
{
    options.Cookie.Name = &quot;MyTempDataCookie&quot;;
});
</code></pre>
<p><img src="../images/18-04-2018-08-30-21.png" class="img-fluid" alt="Configure Cookie" /></p>
<h2 id="session-state">Session State</h2>
<p>Most browsers limit the size of cookies and therefore the data that can be stored in them. If you exceed this limit, you will get a 400 HTTP Error code: The size of the request headers is too long. If you need to store large amounts of data in TempData, you can use the session provider instead. The three steps to implement this are:</p>
<ol>
<li>Call the <code>AddSessionStateTempDataProvider</code> method  in <code>ConfigureServices</code> (chained to <code>AddMvc</code> below)</li>
<li>Call <code>AddSession</code> in <code>ConfigureServices</code></li>
<li>Call <code>app.UseSession</code> in the Configure method</li>
</ol>
<pre><code class="language-csharp" data-lines="3,4,10">public void ConfigureServices(IServiceCollection services)
{
    services.AddMvc().AddSessionStateTempDataProvider();
    services.AddSession();
}

public void Configure(IApplicationBuilder app, IHostingEnvironment env)
{
    app.UseStaticFiles();
    app.UseSession();
    app.UseMvc(routes =&gt;
    {
        routes.MapRoute(
            name: &quot;default&quot;,
            template: &quot;{controller}/{action=Index}/{id?}&quot;);
    });
}
</code></pre>
<h2 id="limitations">Limitations</h2>
<p>You can store simple values in TempData - strings, booleans and numeric types, but if you try to store complex types, you will encounter an InvalidOperationException:</p>
<blockquote class="blockquote">
<p>The '[name of the property]' property with TempDataAttribute is invalid. The 'Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.TempDataSerializer' cannot serialize an object of type '[name of the property]'.</p>
</blockquote>
<p>If you want to use TempData to store complex types, you must serialize it to a string-based format yourself. JSON is the recommended format to use because it is relatively compact (compared to XML) and JSON.Net is included as part of the default project template.</p>
<p>The following class contains two extension methods: one for serialising data to JSON and the other for deserialising it:</p>
<pre><code class="language-csharp">public static class TempDataExtensions
{
    public static void Set&lt;T&gt;(this ITempDataDictionary tempData, string key, T value) where T : class
    {
        tempData[key] = JsonConvert.SerializeObject(value);
    }

    public static T Get&lt;T&gt;(this ITempDataDictionary tempData, string key) where T : class
    {
        tempData.TryGetValue(key, out object o);
        return o == null ? null : JsonConvert.DeserializeObject&lt;T&gt;((string)o);
    }
}
</code></pre>
<p>Usage is straightforward. The second line sets a TempData entry, and the third retrieves it:</p>
<pre><code class="language-csharp">var contact = new Contact { FirstName = &quot;Mike&quot;, Domain = &quot;learnrazorpages.com&quot; };
TempData.Set(&quot;Mike&quot;, contact);
var mike = TempData.Get&lt;Contact&gt;(&quot;Mike&quot;);
</code></pre>

</div>
</div>
<section id="file-meta">
    <span class="file-meta-label">Last updated:</span> <span itemprop="dateModified">01/12/2018 08:58:50</span><br />
</section>

                </div>
                <div class="col-md-3 right-col">
                    
                            <script>
                        (function() {
                            var cx = 'partner-pub-8046723421340367:6108194070';
                            var gcse = document.createElement('script');
                            gcse.type = 'text/javascript';
                            gcse.async = true;
                            gcse.src = '../../cse.google.com/cse07b6.html?cx=' + cx;
                            var s = document.getElementsByTagName('script')[0];
                            s.parentNode.insertBefore(gcse, s);
                        })();
                            </script>
                        <gcse:searchbox-only></gcse:searchbox-only>
                    
                    <div id="doc-outline" class="doc-outline well">
                            <h3 class="doc-outline">On this page</h3>
                            <nav class="doc-outline">
                                <ul>
                                        <li><a itemprop="url" href="#tempdata-in-razor-pages" class="page-scroll">TempData In Razor Pages</a></li>
                                        <li><a itemprop="url" href="#retaining-tempdata-values" class="page-scroll">Retaining TempData Values</a></li>
                                        <li><a itemprop="url" href="#storage-mechanisms" class="page-scroll">Storage Mechanisms</a></li>
                                        <li><a itemprop="url" href="#cookie-configuration" class="page-scroll">Cookie Configuration</a></li>
                                        <li><a itemprop="url" href="#session-state" class="page-scroll">Session State</a></li>
                                        <li><a itemprop="url" href="#limitations" class="page-scroll">Limitations</a></li>
                                </ul>
                            </nav>

                    </div>
                    <div class="rectangle">
                        
                                <script async src="../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
                            <!-- EF Core Rectangle -->
                            <ins class="adsbygoogle"
                                 style="display:inline-block;width:300px;height:250px"
                                 data-ad-client="ca-pub-8046723421340367"
                                 data-ad-slot="7622896857"></ins>
                            <script>
                                (adsbygoogle = window.adsbygoogle || []).push({});
                            </script>
                        
                    </div>
                    <div class="doc-outline well">
                        <h3 class="doc-outline">Latest Updates</h3>
                        <nav class="doc-outline">
                            <ul>
                                    <li><a itemprop="url" href="tutorial/bakery/migration.html">Creating A Migration</a></li>
                                    <li><a itemprop="url" href="tutorial/bakery/create-model.html">Working With A Model</a></li>
                                    <li><a itemprop="url" href="routing.html">Routing in Razor Pages</a></li>
                                    <li><a itemprop="url" href="tutorial/bakery/working-with-data.html">Working With Data</a></li>
                                    <li><a itemprop="url" href="tutorial/bakery/new-page.html">Adding a New Page</a></li>
                                    <li><a itemprop="url" href="tutorial/bakery.html">Creating an Application</a></li>
                            </ul>
                        </nav>
                    </div>
                    <div class="skyscraper">
                        
                                <script async src="../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
                            <!-- EF Core Skyscraper -->
                            <ins class="adsbygoogle"
                                 style="display:inline-block;width:300px;height:600px"
                                 data-ad-client="ca-pub-8046723421340367"
                                 data-ad-slot="4239197376"></ins>
                            <script>
                                (adsbygoogle = window.adsbygoogle || []).push({});
                            </script>
                        
                    </div>
                    <footer>
                        <p>&copy; 2019 - Learn Razor Pages.<br />All rights reserved.</p>
                    </footer>
                </div>
            </div>
        </div>
        <a href="#page-top" id="back-to-top" class="page-scroll" title="Back to top"><i class="fas fa-arrow-alt-circle-up"></i></a>
    </div>
    <div class="cookie-box" id="cookie-warning">
        <div class="cookie-box-contents" id="learnrazorpages">This site uses cookies to analyse traffic, remember your preferences, and optimise your experience.</div>
        <div class="cookie-box-buttons"><a href="../privacy.html" class="cookie-button">Learn more</a><a href="#" class="cookie-button" id="cookie-close">Close</a></div>
    </div>
    <script src="../../ajax.aspnetcdn.com/ajax/jquery/jquery-2.2.0.min.js"></script>
    <script src="../../ajax.aspnetcdn.com/ajax/bootstrap/3.3.6/bootstrap.min.js"></script>
    <script src="../../code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    
    <script src="../../cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
    <script src="../js/site59f2.js?v=gJZRD7PDF8oEm1Xb0uhLZcpf7Vs12fGO-q0DErBSF_Y"></script>
    
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-1264020-21"></script>
        <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-1264020-21');
        </script>
    
    
</body>

<!-- Mirrored from www.learnrazorpages.com/razor-pages/tempdata by HTTrack Website Copier/3.x [XR&CO'2005], Fri, 07 Jun 2019 04:24:48 GMT -->
</html>
