<!DOCTYPE html>
<html>

<!-- Mirrored from www.learnrazorpages.com/razor-pages/tutorial/bakery/create-model by HTTrack Website Copier/3.x [XR&CO'2005], Fri, 07 Jun 2019 04:23:04 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <meta name="google-site-verification" content="MpV6gEoCh9OASgnoi656klwnlkni3_qOenITGlxBrjc" />
    <title>Working With A Model | Learn Razor Pages</title>
    <link rel="canonical" href="create-model.html" />
    <link rel="stylesheet" href="../../../../ajax.aspnetcdn.com/ajax/bootstrap/3.3.6/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,600,600i|Roboto:300i,500,700" />
    <link rel="stylesheet" href="../../../../use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
    <script src="../../../../cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
    <link rel="stylesheet" href="../../../css/site8249.css?v=PCA7f9VuZUscxMwrePJfyFKXCF9mh2dMpXEDQU8oP3o" />
    <link rel="stylesheet" href="../../../css/rp14c5.css?v=ZxkVB0StHjR5-UMElJII7nwWe6Wmc6_qgJ97GsY4yNw" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <script async src="../../../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
        <script>
            (adsbygoogle = window.adsbygoogle || []).push({
                google_ad_client: "ca-pub-8046723421340367",
                enable_page_level_ads: true
            });
        </script>
</head>
<body id="page-top">
    <div class="navbar navbar-default navbar-static-top">
        <div>
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <div class="navbar-brand">
                    <i class="fas fa-graduation-cap"></i> <a href="../../../index.html">Learn Razor Pages</a>
                    <br />
                    <span class="byline">Your guide to using ASP.NET Core Razor Pages</span>
                </div>
                <div class="banner">
                    
                        <script async src="../../../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
                        <!-- EF Core Leaderboard -->
                        <ins class="adsbygoogle"
                             style="display:inline-block;width:728px;height:90px"
                             data-ad-client="ca-pub-8046723421340367"
                             data-ad-slot="1832525889"></ins>
                        <script>
                        (adsbygoogle = window.adsbygoogle || []).push({});
                        </script>                    
                </div>
            </div>

        </div>
    </div>
    <div class="navbar-default sidebar" role="navigation">
        <div class="sidebar-nav navbar-collapse">
            <nav class="main-nav" itemscope itemtype="http://schema.org/SiteNavigationElement">
    <ul class="nav nav-level-one" id="side-menu">
        <li>
            <a itemprop="url" href="../../../index.html">Home</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="../../../first-look.html">A First Look</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../../../asp-net-core.html">ASP.NET Core</a>
        </li>
        <li><a itemprop="url" href="../bakery.html">Tutorials</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="../bakery.html">The Bakery</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../../../razor-pages.html">Razor Page Files</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="../../files/index.html">Razor Files</a></li>
                <li><a itemprop="url" href="../../partial-pages.html">Partial Pages</a></li>
                <li><a itemprop="url" href="../../files/layout.html">Layout Files</a></li>
                <li><a itemprop="url" href="../../files/viewimports.html">ViewImports File</a></li>
                <li><a itemprop="url" href="../../files/viewstart.html">ViewStart File</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../../../razor-syntax.html">Razor Syntax</a>
        </li>
        <li>
            <a itemprop="url" href="../../pagemodel.html">Page Models</a>
            <ul class="nav-level-two">
                <li>
                    <a itemprop="url" href="../../handler-methods.html">Handler Methods</a>
                </li>
                <li>
                    <a itemprop="url" href="../../viewdata.html">ViewData</a>
                </li>
                <li>
                    <a itemprop="url" href="../../action-results.html">Action Results</a>
                </li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../../tag-helpers/index.html">Tag Helpers</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="../../tag-helpers/anchor-tag-helper.html">Anchor Tag Helper</a></li>
                <li><a itemprop="url" href="../../tag-helpers/cache-tag-helper.html">Cache Tag Helper</a></li>
                <li><a itemprop="url" href="../../tag-helpers/distributed-cache-tag-helper.html">Distributed Cache Tag Helper</a></li>
                <li><a itemprop="url" href="../../tag-helpers/environment-tag-helper.html">Environment Tag Helper</a></li>
                <li><a itemprop="url" href="../../tag-helpers/form-action-tag-helper.html">Form Action Tag Helper</a></li>
                <li><a itemprop="url" href="../../tag-helpers/form-tag-helper.html">Form Tag Helper</a></li>
                <li><a itemprop="url" href="../../tag-helpers/image-tag-helper.html">Image Tag Helper</a></li>
                <li><a itemprop="url" href="../../tag-helpers/input-tag-helper.html">Input Tag Helper</a></li>
                <li><a itemprop="url" href="../../tag-helpers/label-tag-helper.html">Label Tag Helper</a></li>
                <li><a itemprop="url" href="../../tag-helpers/link-tag-helper.html">Link Tag Helper</a></li>
                <li><a itemprop="url" href="../../tag-helpers/option-tag-helper.html">Option Tag Helper</a></li>
                <li><a itemprop="url" href="../../tag-helpers/partial-tag-helper.html">Partial Tag Helper</a></li>
                <li><a itemprop="url" href="../../tag-helpers/script-tag-helper.html">Script Tag Helper</a></li>
                <li><a itemprop="url" href="../../tag-helpers/select-tag-helper.html">Select Tag Helper</a></li>
                <li><a itemprop="url" href="../../tag-helpers/textarea-tag-helper.html">TextArea Tag Helper</a></li>
                <li><a itemprop="url" href="../../tag-helpers/validation-message-tag-helper.html">Validation Message Tag Helper</a></li>
                <li><a itemprop="url" href="../../tag-helpers/validation-summary-tag-helper.html">Validation Summary Tag Helper</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../../view-components.html">View Components</a>
        </li>
        <li>
            <a itemprop="url" href="../../routing.html">Routing and URLs</a>
            <ul class="nav-level-two">
                <li><a href="../../../advanced/custom-route-conventions.html">Customising Route Conventions</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../../../startup.html">Startup</a>
        </li>
        <li>
            <a itemprop="url" href="../../../configuration.html">Configuration</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="../../../configuration/global-error-handling.html">Global Error Handling And Logging</a></li>
                <li><a itemprop="url" href="../../../configuration/custom-errors.html">Custom Error Pages</a></li>
                <li><a itemprop="url" href="../../../configuration/https.html">Configuring HTTPS</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../../../middleware.html">Middleware</a>
        </li>
        <li>
            <a itemprop="url" href="../../forms.html">Working With Forms</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="../../forms/file-upload.html">Uploading Files in Razor Pages</a></li>
                <li><a itemprop="url" href="../../forms/checkboxes.html">Working With Checkboxes</a></li>
                <li><a itemprop="url" href="../../forms/select-lists.html">Select Lists in a Razor Pages Form</a></li>
                <li><a itemprop="url" href="../../forms/radios.html">Working With Radio Buttons</a></li>
                <li><a itemprop="url" href="../../../security/request-verification.html">Request Verification</a></li>
            </ul>
        </li>
        <li><a itemprop="url" href="../../validation.html">Validation</a></li>
        <li>
            <a itemprop="url" href="../../model-binding.html">Model Binding</a>
        </li>
        <li>
            <a itemprop="url" href="../../state-management.html">State Management</a>
        </li>
        <li>
            <a itemprop="url" href="../../caching.html">Caching</a>
        </li>
        <li>
            <a itemprop="url" href="../../../identity.html">Managing Security With ASP.NET Identity</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="../../../identity/customising-identity.html">Customising Identity</a></li>
            </ul>
        </li>
        <li>
		<a itemprop="url" href="../../ajax.html">Using AJAX</a>
		<ul class="nav-level-two">
			<li><a itemprop="url" href="../../ajax/form-post.html">Posting Forms</a>    </li>
			<li><a itemprop="url" href="../../ajax/partial-update.html">Partial Page Updates</a></li>
			<li><a itemprop="url" href="../../ajax/upload-files.html">Uploading Files</a></li>
			<li><a itemprop="url" href="../../ajax/unobtrusive-ajax.html">Unobtrusive AJAX</a></li>
		</ul>
	</li>
        <li>
            <a itemprop="url" href="../../../web-api.html">Working with JSON</a>
        </li>
        <li>
            <a itemprop="url" href="../../../miscellaneous/scaffolding.html">Scaffolding</a>
        </li>
        <li>
            <a itemprop="url" href="../../../publishing/publish-to-iis.html">Publishing To IIS</a>
        </li>
        <li>
            <a itemprop="url" href="../../../advanced.html">Advanced</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="../../../advanced/areas.html">Areas</a></li>
                <li><a itemprop="url" href="../../../advanced/custom-tag-helpers.html">Custom Tag Helpers</a></li>
                <li><a itemprop="url" href="../../../advanced/custom-route-conventions.html">Customising Route Conventions</a></li>
                <li><a itemprop="url" href="../../../advanced/custom-constraints.html">Custom Route Constraints</a></li>
                <li><a itemprop="url" href="../../../advanced/route-parameter-transformers.html">Parameter Transformers For Routes</a></li>
                <li><a itemprop="url" href="../../../advanced/dependency-injection.html">Dependency Injection</a></li>
                <li><a itemprop="url" href="../../filters.html">Filters</a></li>
                <li><a itemprop="url" href="../../../advanced/razor-class-library.html">Razor Class Libraries</a></li>
                <li><a itemprop="url" href="../../../advanced/render-partial-to-string.html">Rendering A Partial View To A String</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../../../table-of-contents.html">Table Of Contents</a>
        </li>
    </ul>
</nav>

            <footer>
                <p>&copy; 2019 - Learn Razor Pages.<br />All rights reserved.</p>
            </footer>
        </div>
        <!-- /.sidebar-collapse -->
    </div>

    <div id="page-wrapper">
        <div class="body-content">
            <div class="row">
                <div class="col-md-9">
                    
<div id="article">
    <h1 itemprop="headline" id="working-with-a-model">Working With A Model</h1>
<div itemprop="articleBody"><p>When working with data in a .NET application, you have a choice. You can either move data around the application in recordset or dataset structures, or you can represent the things (or <em>entities</em>) that your application is concerned with as <a href="https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/classes">classes</a>, and use instances of those as containers for individual rows of data from the database.</p>
<p>The second approach is recommended, because it enables you to work with data in a strongly-typed manner - which has the dual benefit of offering compile-time checking thereby reducing runtime errors, and (hopefully) better quality code. It is a lot easier to reason about and maintain code where a piece of data is represented as <code>Person.FirstName</code> instead of <code>ds.Tables[0].Rows[0][&quot;FirstName&quot;]</code>, which is the way that you would access an item of data in an <a href="https://docs.microsoft.com/en-us/dotnet/framework/data/adonet/ado-net-datasets">ADO.NET DataSet object</a>.</p>
<p>Collectively, the code representation of your application's entities is known as the <em>Model</em>.  The Bakery application is currently concerned with <em><strong>products</strong></em> sold by the Fourth Coffee store, so the model consists of one class: <code>Product</code>.</p>
<h2 id="creating-the-model">Creating the model</h2>
<p>Add a new folder to the root of the application named <em>Models</em>. If you have installed the &quot;C# Extensions&quot; extension, right-click on the folder and choose <strong>New C# Class</strong>:</p>
<p><img src="../../../images/22-11-2018-14-07-40.png" class="img-fluid" alt="Add C# Class" /></p>
<p>Name the class <code>Product</code> in the dialog when prompted, and hit <strong>Enter</strong>. The generated file should have the following content:</p>
<pre><code class="language-csharp">namespace Bakery.Models
{
    public class Product
    {
        
    }
}
</code></pre>
<p>Add the following highlighted lines to the <code>Product</code> class:</p>
<pre><code class="language-csharp" data-lines="5-9">namespace Bakery.Models
{
    public class Product
    {
        public int Id { get; set; }
        public string Name { get; set; }
        public string Description { get; set; }
        public decimal Price { get; set; }
        public string ImageName { get; set; }
    }
}
</code></pre>
<p>The properties of the <code>Product</code> class are taken from the columns names in the Products table of the database that comes with the original sample site. Most modern web applications use a data access technology that automatically maps tables and columns in a database with an application's model classes and their properties, enabling two-way transfer of data between database and model. These components are known a Object-Relational Mappers - ORMs. Full-featured ORMs also generate the SQL commands and execute them against the database, as well as offering other services like transaction management and migrations.</p>
<p>The recommended ORM to use with ASP.NET Core applications is <a href="https://www.learnentityframeworkcore.com/">Entity Framework Core</a> (EF Core). In the next step you will add it to the application.</p>
<h2 id="adding-entity-framework-core">Adding Entity Framework Core</h2>
<p>EF Core includes a number of <em>providers</em> - components that work with specific databases. Many providers are maintained by third parties. The EF Core team maintain providers for SQL Server, and SQLite - a cross platform file-based database which will be used in this exercise.</p>
<p>EF Core is not included in the project template by default. It comes as a Nuget package which can be installed via the <code>dotnet add package</code> command. To install it with the SQLite provider into the Bakery site, execute the following command from the terminal:</p>
<pre><code class="language-cmd">dotnet add package Microsoft.EntityFrameworkCore.Sqlite
</code></pre>
<p>The terminal will advise you when the operation has been completed successfully.</p>
<h2 id="adding-and-registering-a-context">Adding And Registering A Context</h2>
<p>The primary EF Core component that you will use to communicate with the database is a class that derives from <code>DbContext</code>, known as the <a href="https://www.learnentityframeworkcore.com/dbcontext">context</a>. The context represents a session with a database and provides an API for communicating with it with the following capabilities:</p>
<ul>
<li>Database Connections</li>
<li>Data operations such as querying and persistance</li>
<li>Change Tracking</li>
<li>Model building</li>
<li>Data Mapping</li>
<li>Object caching</li>
<li>Transaction management</li>
</ul>
<p>To add one, create a folder named <em>Data</em> in the root of the project. Then add a C# class file to it named <em>BakeryContext.cs</em>. Amend the content as follows:</p>
<pre><code class="language-csharp">using Bakery.Models;
using Microsoft.EntityFrameworkCore;

namespace Bakery.Data
{
    public class BakeryContext : DbContext
    {
        public DbSet&lt;Product&gt; Products { get; set; }
        
        protected override void OnConfiguring(DbContextOptionsBuilder optionsBuilder)
        {
            optionsBuilder.UseSqlite(@&quot;Data source=Bakery.db&quot;);
        }
    }
}
</code></pre>
<p>This is the context that you will use to work with your data. The context has one property - a <a href="https://www.learnentityframeworkcore.com/dbset">DbSet</a> named <em>Products</em>. The <code>DbSet</code> class maps to a table in the database.</p>
<p>The <code>OnConfiguring</code> method provides a place for you to configure your context. In this case, you have configured the context to use the SQLite provider, and you have specified the connection string to be used.</p>
<p>When working with a context, you can instantiate an instance wherever you need it, e.g.</p>
<pre><code class="language-csharp">using(var context = new BakeryContext())
{
    // do something with data
}
</code></pre>
<p>However, the recommended approach to working with contexts in an ASP.NET Core application is to register it with the dependency injection system and make it available as a &quot;service&quot;. Service registration takes place in the <code>ConfigureServices</code> method in the Startup class.</p>
<p>To complete this step, open the <em>Startup.cs</em> file and add a <code>using</code> directive to bring the <code>Bakery.Data</code> namespace into scope:</p>
<pre><code class="language-csharp" data-lines="4">...
using Microsoft.Extensions.Configuration;
using Microsoft.Extensions.DependencyInjection;
using Bakery.Data;  

namespace Bakery
{
    public class Startup
    {
        ...
</code></pre>
<p>Then add the highlighted line of code to the <code>ConfigureServices</code> method below:</p>
<pre><code class="language-csharp" data-lines="10">public void ConfigureServices(IServiceCollection services)
{
    services.Configure&lt;CookiePolicyOptions&gt;(options =&gt;
    {
        // This lambda determines whether user consent for non-essential cookies is needed for a given request.
        options.CheckConsentNeeded = context =&gt; true;
        options.MinimumSameSitePolicy = SameSiteMode.None;
    });

    services.AddDbContext&lt;BakeryContext&gt;();
    services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_2);
}
</code></pre>
<p>Now the context can be made available within a PageModel class by injecting it via the class constructor. There is no need to manage the lifetime of the context. The <code>AddDbContect</code> method registers the context with a <code>Scoped</code> lifetime, meaning that a new one will be made available for an entire request. The services container will take care of ensuring that it is disposed of correctly.</p>
<h3 id="summary">Summary</h3>
<p>You now have a model (small, but still a model), and an EF Core context. All you need now is a database. In the next section, you will see how EF Core migrations can be used to create one.</p>
<div class="pull-right"><p>Next: <a href="migration.html">Creating a Migration</a></p>
</div>
<div class="pull-left"><p>Previous: <a href="new-page.html">Adding a New Page</a></p>
</div>

</div>
</div>
<section id="file-meta">
    <span class="file-meta-label">Last updated:</span> <span itemprop="dateModified">29/05/2019 08:02:40</span><br />
</section>

                </div>
                <div class="col-md-3 right-col">
                    
                            <script>
                        (function() {
                            var cx = 'partner-pub-8046723421340367:6108194070';
                            var gcse = document.createElement('script');
                            gcse.type = 'text/javascript';
                            gcse.async = true;
                            gcse.src = '../../../../cse.google.com/cse07b6.html?cx=' + cx;
                            var s = document.getElementsByTagName('script')[0];
                            s.parentNode.insertBefore(gcse, s);
                        })();
                            </script>
                        <gcse:searchbox-only></gcse:searchbox-only>
                    
                    <div id="doc-outline" class="doc-outline well">
                            <h3 class="doc-outline">On this page</h3>
                            <nav class="doc-outline">
                                <ul>
                                        <li><a itemprop="url" href="#working-with-a-model" class="page-scroll">Working With A Model</a></li>
                                        <li><a itemprop="url" href="#creating-the-model" class="page-scroll">Creating the model</a></li>
                                        <li><a itemprop="url" href="#adding-entity-framework-core" class="page-scroll">Adding Entity Framework Core</a></li>
                                        <li><a itemprop="url" href="#adding-and-registering-a-context" class="page-scroll">Adding And Registering A Context</a></li>
                                        <li><a itemprop="url" href="#summary" class="page-scroll">Summary</a></li>
                                </ul>
                            </nav>

                    </div>
                    <div class="rectangle">
                        
                                <script async src="../../../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
                            <!-- EF Core Rectangle -->
                            <ins class="adsbygoogle"
                                 style="display:inline-block;width:300px;height:250px"
                                 data-ad-client="ca-pub-8046723421340367"
                                 data-ad-slot="7622896857"></ins>
                            <script>
                                (adsbygoogle = window.adsbygoogle || []).push({});
                            </script>
                        
                    </div>
                    <div class="doc-outline well">
                        <h3 class="doc-outline">Latest Updates</h3>
                        <nav class="doc-outline">
                            <ul>
                                    <li><a itemprop="url" href="migration.html">Creating A Migration</a></li>
                                    <li><a itemprop="url" href="create-model.html">Working With A Model</a></li>
                                    <li><a itemprop="url" href="../../routing.html">Routing in Razor Pages</a></li>
                                    <li><a itemprop="url" href="working-with-data.html">Working With Data</a></li>
                                    <li><a itemprop="url" href="new-page.html">Adding a New Page</a></li>
                                    <li><a itemprop="url" href="../bakery.html">Creating an Application</a></li>
                            </ul>
                        </nav>
                    </div>
                    <div class="skyscraper">
                        
                                <script async src="../../../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
                            <!-- EF Core Skyscraper -->
                            <ins class="adsbygoogle"
                                 style="display:inline-block;width:300px;height:600px"
                                 data-ad-client="ca-pub-8046723421340367"
                                 data-ad-slot="4239197376"></ins>
                            <script>
                                (adsbygoogle = window.adsbygoogle || []).push({});
                            </script>
                        
                    </div>
                    <footer>
                        <p>&copy; 2019 - Learn Razor Pages.<br />All rights reserved.</p>
                    </footer>
                </div>
            </div>
        </div>
        <a href="#page-top" id="back-to-top" class="page-scroll" title="Back to top"><i class="fas fa-arrow-alt-circle-up"></i></a>
    </div>
    <div class="cookie-box" id="cookie-warning">
        <div class="cookie-box-contents" id="learnrazorpages">This site uses cookies to analyse traffic, remember your preferences, and optimise your experience.</div>
        <div class="cookie-box-buttons"><a href="../../../privacy.html" class="cookie-button">Learn more</a><a href="#" class="cookie-button" id="cookie-close">Close</a></div>
    </div>
    <script src="../../../../ajax.aspnetcdn.com/ajax/jquery/jquery-2.2.0.min.js"></script>
    <script src="../../../../ajax.aspnetcdn.com/ajax/bootstrap/3.3.6/bootstrap.min.js"></script>
    <script src="../../../../code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    
    <script src="../../../../cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
    <script src="../../../js/site59f2.js?v=gJZRD7PDF8oEm1Xb0uhLZcpf7Vs12fGO-q0DErBSF_Y"></script>
    
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-1264020-21"></script>
        <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-1264020-21');
        </script>
    
    
</body>

<!-- Mirrored from www.learnrazorpages.com/razor-pages/tutorial/bakery/create-model by HTTrack Website Copier/3.x [XR&CO'2005], Fri, 07 Jun 2019 04:23:04 GMT -->
</html>
