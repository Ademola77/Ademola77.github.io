<!DOCTYPE html>
<html>

<!-- Mirrored from www.learnrazorpages.com/razor-pages/tutorial/bakery/email by HTTrack Website Copier/3.x [XR&CO'2005], Fri, 07 Jun 2019 04:24:43 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <meta name="google-site-verification" content="MpV6gEoCh9OASgnoi656klwnlkni3_qOenITGlxBrjc" />
    <title>Adding Email | Learn Razor Pages</title>
    <link rel="canonical" href="email.html" />
    <link rel="stylesheet" href="../../../../ajax.aspnetcdn.com/ajax/bootstrap/3.3.6/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,600,600i|Roboto:300i,500,700" />
    <link rel="stylesheet" href="../../../../use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
    <script src="../../../../cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
    <link rel="stylesheet" href="../../../css/site8249.css?v=PCA7f9VuZUscxMwrePJfyFKXCF9mh2dMpXEDQU8oP3o" />
    <link rel="stylesheet" href="../../../css/rp14c5.css?v=ZxkVB0StHjR5-UMElJII7nwWe6Wmc6_qgJ97GsY4yNw" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <script async src="../../../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
        <script>
            (adsbygoogle = window.adsbygoogle || []).push({
                google_ad_client: "ca-pub-8046723421340367",
                enable_page_level_ads: true
            });
        </script>
</head>
<body id="page-top">
    <div class="navbar navbar-default navbar-static-top">
        <div>
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <div class="navbar-brand">
                    <i class="fas fa-graduation-cap"></i> <a href="../../../index.html">Learn Razor Pages</a>
                    <br />
                    <span class="byline">Your guide to using ASP.NET Core Razor Pages</span>
                </div>
                <div class="banner">
                    
                        <script async src="../../../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
                        <!-- EF Core Leaderboard -->
                        <ins class="adsbygoogle"
                             style="display:inline-block;width:728px;height:90px"
                             data-ad-client="ca-pub-8046723421340367"
                             data-ad-slot="1832525889"></ins>
                        <script>
                        (adsbygoogle = window.adsbygoogle || []).push({});
                        </script>                    
                </div>
            </div>

        </div>
    </div>
    <div class="navbar-default sidebar" role="navigation">
        <div class="sidebar-nav navbar-collapse">
            <nav class="main-nav" itemscope itemtype="http://schema.org/SiteNavigationElement">
    <ul class="nav nav-level-one" id="side-menu">
        <li>
            <a itemprop="url" href="../../../index.html">Home</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="../../../first-look.html">A First Look</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../../../asp-net-core.html">ASP.NET Core</a>
        </li>
        <li><a itemprop="url" href="../bakery.html">Tutorials</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="../bakery.html">The Bakery</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../../../razor-pages.html">Razor Page Files</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="../../files/index.html">Razor Files</a></li>
                <li><a itemprop="url" href="../../partial-pages.html">Partial Pages</a></li>
                <li><a itemprop="url" href="../../files/layout.html">Layout Files</a></li>
                <li><a itemprop="url" href="../../files/viewimports.html">ViewImports File</a></li>
                <li><a itemprop="url" href="../../files/viewstart.html">ViewStart File</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../../../razor-syntax.html">Razor Syntax</a>
        </li>
        <li>
            <a itemprop="url" href="../../pagemodel.html">Page Models</a>
            <ul class="nav-level-two">
                <li>
                    <a itemprop="url" href="../../handler-methods.html">Handler Methods</a>
                </li>
                <li>
                    <a itemprop="url" href="../../viewdata.html">ViewData</a>
                </li>
                <li>
                    <a itemprop="url" href="../../action-results.html">Action Results</a>
                </li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../../tag-helpers/index.html">Tag Helpers</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="../../tag-helpers/anchor-tag-helper.html">Anchor Tag Helper</a></li>
                <li><a itemprop="url" href="../../tag-helpers/cache-tag-helper.html">Cache Tag Helper</a></li>
                <li><a itemprop="url" href="../../tag-helpers/distributed-cache-tag-helper.html">Distributed Cache Tag Helper</a></li>
                <li><a itemprop="url" href="../../tag-helpers/environment-tag-helper.html">Environment Tag Helper</a></li>
                <li><a itemprop="url" href="../../tag-helpers/form-action-tag-helper.html">Form Action Tag Helper</a></li>
                <li><a itemprop="url" href="../../tag-helpers/form-tag-helper.html">Form Tag Helper</a></li>
                <li><a itemprop="url" href="../../tag-helpers/image-tag-helper.html">Image Tag Helper</a></li>
                <li><a itemprop="url" href="../../tag-helpers/input-tag-helper.html">Input Tag Helper</a></li>
                <li><a itemprop="url" href="../../tag-helpers/label-tag-helper.html">Label Tag Helper</a></li>
                <li><a itemprop="url" href="../../tag-helpers/link-tag-helper.html">Link Tag Helper</a></li>
                <li><a itemprop="url" href="../../tag-helpers/option-tag-helper.html">Option Tag Helper</a></li>
                <li><a itemprop="url" href="../../tag-helpers/partial-tag-helper.html">Partial Tag Helper</a></li>
                <li><a itemprop="url" href="../../tag-helpers/script-tag-helper.html">Script Tag Helper</a></li>
                <li><a itemprop="url" href="../../tag-helpers/select-tag-helper.html">Select Tag Helper</a></li>
                <li><a itemprop="url" href="../../tag-helpers/textarea-tag-helper.html">TextArea Tag Helper</a></li>
                <li><a itemprop="url" href="../../tag-helpers/validation-message-tag-helper.html">Validation Message Tag Helper</a></li>
                <li><a itemprop="url" href="../../tag-helpers/validation-summary-tag-helper.html">Validation Summary Tag Helper</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../../view-components.html">View Components</a>
        </li>
        <li>
            <a itemprop="url" href="../../routing.html">Routing and URLs</a>
            <ul class="nav-level-two">
                <li><a href="../../../advanced/custom-route-conventions.html">Customising Route Conventions</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../../../startup.html">Startup</a>
        </li>
        <li>
            <a itemprop="url" href="../../../configuration.html">Configuration</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="../../../configuration/global-error-handling.html">Global Error Handling And Logging</a></li>
                <li><a itemprop="url" href="../../../configuration/custom-errors.html">Custom Error Pages</a></li>
                <li><a itemprop="url" href="../../../configuration/https.html">Configuring HTTPS</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../../../middleware.html">Middleware</a>
        </li>
        <li>
            <a itemprop="url" href="../../forms.html">Working With Forms</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="../../forms/file-upload.html">Uploading Files in Razor Pages</a></li>
                <li><a itemprop="url" href="../../forms/checkboxes.html">Working With Checkboxes</a></li>
                <li><a itemprop="url" href="../../forms/select-lists.html">Select Lists in a Razor Pages Form</a></li>
                <li><a itemprop="url" href="../../forms/radios.html">Working With Radio Buttons</a></li>
                <li><a itemprop="url" href="../../../security/request-verification.html">Request Verification</a></li>
            </ul>
        </li>
        <li><a itemprop="url" href="../../validation.html">Validation</a></li>
        <li>
            <a itemprop="url" href="../../model-binding.html">Model Binding</a>
        </li>
        <li>
            <a itemprop="url" href="../../state-management.html">State Management</a>
        </li>
        <li>
            <a itemprop="url" href="../../caching.html">Caching</a>
        </li>
        <li>
            <a itemprop="url" href="../../../identity.html">Managing Security With ASP.NET Identity</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="../../../identity/customising-identity.html">Customising Identity</a></li>
            </ul>
        </li>
        <li>
		<a itemprop="url" href="../../ajax.html">Using AJAX</a>
		<ul class="nav-level-two">
			<li><a itemprop="url" href="../../ajax/form-post.html">Posting Forms</a>    </li>
			<li><a itemprop="url" href="../../ajax/partial-update.html">Partial Page Updates</a></li>
			<li><a itemprop="url" href="../../ajax/upload-files.html">Uploading Files</a></li>
			<li><a itemprop="url" href="../../ajax/unobtrusive-ajax.html">Unobtrusive AJAX</a></li>
		</ul>
	</li>
        <li>
            <a itemprop="url" href="../../../web-api.html">Working with JSON</a>
        </li>
        <li>
            <a itemprop="url" href="../../../miscellaneous/scaffolding.html">Scaffolding</a>
        </li>
        <li>
            <a itemprop="url" href="../../../publishing/publish-to-iis.html">Publishing To IIS</a>
        </li>
        <li>
            <a itemprop="url" href="../../../advanced.html">Advanced</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="../../../advanced/areas.html">Areas</a></li>
                <li><a itemprop="url" href="../../../advanced/custom-tag-helpers.html">Custom Tag Helpers</a></li>
                <li><a itemprop="url" href="../../../advanced/custom-route-conventions.html">Customising Route Conventions</a></li>
                <li><a itemprop="url" href="../../../advanced/custom-constraints.html">Custom Route Constraints</a></li>
                <li><a itemprop="url" href="../../../advanced/route-parameter-transformers.html">Parameter Transformers For Routes</a></li>
                <li><a itemprop="url" href="../../../advanced/dependency-injection.html">Dependency Injection</a></li>
                <li><a itemprop="url" href="../../filters.html">Filters</a></li>
                <li><a itemprop="url" href="../../../advanced/razor-class-library.html">Razor Class Libraries</a></li>
                <li><a itemprop="url" href="../../../advanced/render-partial-to-string.html">Rendering A Partial View To A String</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../../../table-of-contents.html">Table Of Contents</a>
        </li>
    </ul>
</nav>

            <footer>
                <p>&copy; 2019 - Learn Razor Pages.<br />All rights reserved.</p>
            </footer>
        </div>
        <!-- /.sidebar-collapse -->
    </div>

    <div id="page-wrapper">
        <div class="body-content">
            <div class="row">
                <div class="col-md-9">
                    
<div id="article">
    <h1 itemprop="headline" id="adding-email">Adding Email</h1>
<div itemprop="articleBody"><p>In the last section, you added a form to the Bakery site to collect information from the customer. Now you are going to process the content of that form to generate an email.</p>
<p>Prior to adding code for email, finish the <em>OrderSuccess.cshtml</em> page off by adding the following:</p>
<pre><code class="language-html">&lt;div class=&quot;message order-success&quot;&gt;
    &lt;h2&gt;Thank you for your order!&lt;/h2&gt;
    &lt;p&gt;We are processing your order and have sent a confirmation email. Thank you for your business and enjoy!&lt;/p&gt;
&lt;/div&gt;
</code></pre>
<h2 id="email-in.net">Email in .NET</h2>
<p>Sending email in .NET is quite easy. There isn't much code required for a basic email. All you need to do is to add a <code>using</code>directive to the top of <em>Order.cshtml.cs</em>:</p>
<pre><code class="language-csharp">using System.Net.Mail;
</code></pre>
<p>and then add the following highlighted code to the OnPostAsync method in the same file:</p>
<pre><code class="language-csharp" data-lines="6-22">public async Task&lt;IActionResult&gt; OnPostAsync()
{
    Product = await db.Products.FindAsync(Id);
    if(ModelState.IsValid){
        
        var body = <a href="../../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="d0f490">[email&#160;protected]</a>&quot;&lt;p&gt;Thank you, we have received your order for {OrderQuantity} unit(s) of {Product.Name}!&lt;/p&gt;
        &lt;p&gt;Your address is: &lt;br/&gt;{OrderShipping.Replace(&quot;\n&quot;, &quot;&lt;br/&gt;&quot;)}&lt;/p&gt;
        Your total is ${Product.Price * OrderQuantity}.&lt;br/&gt;
        We will contact you if we have questions about your order.  Thanks!&lt;br/&gt;&quot;;

        using(var smtp = new SmtpClient())
        {
            smtp.DeliveryMethod = SmtpDeliveryMethod.SpecifiedPickupDirectory;
            smtp.PickupDirectoryLocation = @&quot;c:\mailpickup&quot;;
            var message = new MailMessage();
            message.To.Add(OrderEmail);
            message.Subject = &quot;Fourth Coffee - New Order&quot;;
            message.Body = body;
            message.IsBodyHtml = true;
            message.From = new MailAddress(&quot;<a href="../../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="d1a2b0bdb4a291b7bea4a3a5b9b2beb7b7b4b4ffb2bebc">[email&#160;protected]</a>&quot;);
            await smtp.SendMailAsync(message);
        }

        return RedirectToPage(&quot;OrderSuccess&quot;);
    }
    return Page();
}
</code></pre>
<p>This code uses the <code>SpecifiedPickupDirectory</code> option for the delivery method, ensuring that the resulting email is created in a local folder. That way, it's easy to test that everything worked by simply looking in the specified folder. Feel free to alter the location to somewhere that suits your environment.</p>
<p>Now run the application and select a product. Then enter valid values into the form and process the order. You should find an <em>eml</em> file in the specified folder, containing the generated message:</p>
<p><img src="../../../images/04-12-2018-13-56-19.png" class="img-fluid" alt="Adding Email To Razor Pages" /></p>
<h2 id="emailing-options">Emailing Options</h2>
<p>This version doesn't actually send an email anywhere. You can however test sending email via Gmail or Outlook/Hotmail/Live or indeed any other service provider that allows you to connect to their mail servers. Here are the standard configuration settings for Gmail and Microsoft's email services, which are virtually the same as eachother:</p>
<table class="table">
<thead>
<tr>
<th style="text-align: left;"></th>
<th style="text-align: left;">Gmail</th>
<th style="text-align: left;">Outlook/Live</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Host</td>
<td style="text-align: left;">smtp.gmail.com</td>
<td style="text-align: left;">smtp-mail.outlook.com</td>
</tr>
<tr>
<td style="text-align: left;">Port</td>
<td style="text-align: left;">587</td>
<td style="text-align: left;">587</td>
</tr>
<tr>
<td style="text-align: left;">EnableSsl</td>
<td style="text-align: left;">true</td>
<td style="text-align: left;">true</td>
</tr>
<tr>
<td style="text-align: left;">User Name</td>
<td style="text-align: left;">Your email address</td>
<td style="text-align: left;">Your email address</td>
</tr>
<tr>
<td style="text-align: left;">Password</td>
<td style="text-align: left;">Your account password</td>
<td style="text-align: left;">Your account password</td>
</tr>
</tbody>
</table>
<p>You should check your provider's documentation for the correct values if you aren't using either of the services featured here. You can also send email to Port 465, but your site must be running under HTTPS for this to work, and you should not set <code>EnableSsl</code> to <code>true</code> when doing so.</p>
<p>The next code block shows how to alter the example above to make use of Gmail:</p>
<pre><code class="language-csharp">using(var smtp = new SmtpClient())
{
    var credential = new NetworkCredential
    {
        UserName = &quot;<a href="../../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="bfdac7ded2cfd3daffd8d2ded6d391dcd0d2">[email&#160;protected]</a>&quot;,  // replace with valid value
        Password = &quot;password&quot;  // replace with valid value
    };
    smtp.Credentials = credential;
    smtp.Host = &quot;smtp.gmail.com&quot;;
    smtp.Port = 587;
    smtp.EnableSsl = true;
    message.To.Add(OrderEmail);
    message.Subject = &quot;Fourth Coffee - New Order&quot;;
    message.Body = body;
    message.IsBodyHtml = true;
    message.From = new MailAddress(&quot;<a href="../../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="711409101c011d1431161c10181d5f121e1c">[email&#160;protected]</a>&quot;);
    await smtp.SendMailAsync(message);
}
</code></pre>
<p>Note that email service providers like Gmail typically do not allow you to send email from an address other than those associated with the account that you are using.</p>
<h3 id="summary">Summary</h3>
<p>Now that you have reached this point, the port from the ASP.NET Web Pages Bakery template is complete. The Razor Pages version is available on Github, but things do not stop there. Further sections are planned which will cover more Razor Pages functionality. Once completed, the next section will look at scaffolding CRUD pages so that you can add more products to the database, and modify the existing ones.</p>
<div class="pull-left"><p>Previous: <a href="forms.html">Working With Forms</a></p>
</div>

</div>
</div>
<section id="file-meta">
    <span class="file-meta-label">Last updated:</span> <span itemprop="dateModified">07/12/2018 07:40:53</span><br />
</section>

                </div>
                <div class="col-md-3 right-col">
                    
                            <script data-cfasync="false" src="../../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
                        (function() {
                            var cx = 'partner-pub-8046723421340367:6108194070';
                            var gcse = document.createElement('script');
                            gcse.type = 'text/javascript';
                            gcse.async = true;
                            gcse.src = '../../../../cse.google.com/cse07b6.html?cx=' + cx;
                            var s = document.getElementsByTagName('script')[0];
                            s.parentNode.insertBefore(gcse, s);
                        })();
                            </script>
                        <gcse:searchbox-only></gcse:searchbox-only>
                    
                    <div id="doc-outline" class="doc-outline well">
                            <h3 class="doc-outline">On this page</h3>
                            <nav class="doc-outline">
                                <ul>
                                        <li><a itemprop="url" href="#adding-email" class="page-scroll">Adding Email</a></li>
                                        <li><a itemprop="url" href="#email-in.net" class="page-scroll">Email in .NET</a></li>
                                        <li><a itemprop="url" href="#emailing-options" class="page-scroll">Emailing Options</a></li>
                                        <li><a itemprop="url" href="#summary" class="page-scroll">Summary</a></li>
                                </ul>
                            </nav>

                    </div>
                    <div class="rectangle">
                        
                                <script async src="../../../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
                            <!-- EF Core Rectangle -->
                            <ins class="adsbygoogle"
                                 style="display:inline-block;width:300px;height:250px"
                                 data-ad-client="ca-pub-8046723421340367"
                                 data-ad-slot="7622896857"></ins>
                            <script>
                                (adsbygoogle = window.adsbygoogle || []).push({});
                            </script>
                        
                    </div>
                    <div class="doc-outline well">
                        <h3 class="doc-outline">Latest Updates</h3>
                        <nav class="doc-outline">
                            <ul>
                                    <li><a itemprop="url" href="migration.html">Creating A Migration</a></li>
                                    <li><a itemprop="url" href="create-model.html">Working With A Model</a></li>
                                    <li><a itemprop="url" href="../../routing.html">Routing in Razor Pages</a></li>
                                    <li><a itemprop="url" href="working-with-data.html">Working With Data</a></li>
                                    <li><a itemprop="url" href="new-page.html">Adding a New Page</a></li>
                                    <li><a itemprop="url" href="../bakery.html">Creating an Application</a></li>
                            </ul>
                        </nav>
                    </div>
                    <div class="skyscraper">
                        
                                <script async src="../../../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
                            <!-- EF Core Skyscraper -->
                            <ins class="adsbygoogle"
                                 style="display:inline-block;width:300px;height:600px"
                                 data-ad-client="ca-pub-8046723421340367"
                                 data-ad-slot="4239197376"></ins>
                            <script>
                                (adsbygoogle = window.adsbygoogle || []).push({});
                            </script>
                        
                    </div>
                    <footer>
                        <p>&copy; 2019 - Learn Razor Pages.<br />All rights reserved.</p>
                    </footer>
                </div>
            </div>
        </div>
        <a href="#page-top" id="back-to-top" class="page-scroll" title="Back to top"><i class="fas fa-arrow-alt-circle-up"></i></a>
    </div>
    <div class="cookie-box" id="cookie-warning">
        <div class="cookie-box-contents" id="learnrazorpages">This site uses cookies to analyse traffic, remember your preferences, and optimise your experience.</div>
        <div class="cookie-box-buttons"><a href="../../../privacy.html" class="cookie-button">Learn more</a><a href="#" class="cookie-button" id="cookie-close">Close</a></div>
    </div>
    <script src="../../../../ajax.aspnetcdn.com/ajax/jquery/jquery-2.2.0.min.js"></script>
    <script src="../../../../ajax.aspnetcdn.com/ajax/bootstrap/3.3.6/bootstrap.min.js"></script>
    <script src="../../../../code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    
    <script src="../../../../cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
    <script src="../../../js/site59f2.js?v=gJZRD7PDF8oEm1Xb0uhLZcpf7Vs12fGO-q0DErBSF_Y"></script>
    
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-1264020-21"></script>
        <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-1264020-21');
        </script>
    
    
</body>

<!-- Mirrored from www.learnrazorpages.com/razor-pages/tutorial/bakery/email by HTTrack Website Copier/3.x [XR&CO'2005], Fri, 07 Jun 2019 04:24:43 GMT -->
</html>
