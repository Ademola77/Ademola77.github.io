<!DOCTYPE html>
<html>

<!-- Mirrored from www.learnrazorpages.com/advanced/razor-class-library by HTTrack Website Copier/3.x [XR&CO'2005], Fri, 07 Jun 2019 04:22:01 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Razor Class libraries (RCLs) were introduced in ASP.NET Core 2.1 as a way to package and distribute UI components to be referenced and consumed within a host application." />
    <meta name="google-site-verification" content="MpV6gEoCh9OASgnoi656klwnlkni3_qOenITGlxBrjc" />
    <title>Razor Class Libraries in ASP.NET Core | Learn Razor Pages</title>
    <link rel="canonical" href="razor-class-library.html" />
    <link rel="stylesheet" href="../../ajax.aspnetcdn.com/ajax/bootstrap/3.3.6/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,600,600i|Roboto:300i,500,700" />
    <link rel="stylesheet" href="../../use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
    <script src="../../cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
    <link rel="stylesheet" href="../css/site8249.css?v=PCA7f9VuZUscxMwrePJfyFKXCF9mh2dMpXEDQU8oP3o" />
    <link rel="stylesheet" href="../css/rp14c5.css?v=ZxkVB0StHjR5-UMElJII7nwWe6Wmc6_qgJ97GsY4yNw" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <script async src="../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
        <script>
            (adsbygoogle = window.adsbygoogle || []).push({
                google_ad_client: "ca-pub-8046723421340367",
                enable_page_level_ads: true
            });
        </script>
</head>
<body id="page-top">
    <div class="navbar navbar-default navbar-static-top">
        <div>
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <div class="navbar-brand">
                    <i class="fas fa-graduation-cap"></i> <a href="../index.html">Learn Razor Pages</a>
                    <br />
                    <span class="byline">Your guide to using ASP.NET Core Razor Pages</span>
                </div>
                <div class="banner">
                    
                        <script async src="../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
                        <!-- EF Core Leaderboard -->
                        <ins class="adsbygoogle"
                             style="display:inline-block;width:728px;height:90px"
                             data-ad-client="ca-pub-8046723421340367"
                             data-ad-slot="1832525889"></ins>
                        <script>
                        (adsbygoogle = window.adsbygoogle || []).push({});
                        </script>                    
                </div>
            </div>

        </div>
    </div>
    <div class="navbar-default sidebar" role="navigation">
        <div class="sidebar-nav navbar-collapse">
            <nav class="main-nav" itemscope itemtype="http://schema.org/SiteNavigationElement">
    <ul class="nav nav-level-one" id="side-menu">
        <li>
            <a itemprop="url" href="../index.html">Home</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="../first-look.html">A First Look</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../asp-net-core.html">ASP.NET Core</a>
        </li>
        <li><a itemprop="url" href="../razor-pages/tutorial/bakery.html">Tutorials</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="../razor-pages/tutorial/bakery.html">The Bakery</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../razor-pages.html">Razor Page Files</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="../razor-pages/files/index.html">Razor Files</a></li>
                <li><a itemprop="url" href="../razor-pages/partial-pages.html">Partial Pages</a></li>
                <li><a itemprop="url" href="../razor-pages/files/layout.html">Layout Files</a></li>
                <li><a itemprop="url" href="../razor-pages/files/viewimports.html">ViewImports File</a></li>
                <li><a itemprop="url" href="../razor-pages/files/viewstart.html">ViewStart File</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../razor-syntax.html">Razor Syntax</a>
        </li>
        <li>
            <a itemprop="url" href="../razor-pages/pagemodel.html">Page Models</a>
            <ul class="nav-level-two">
                <li>
                    <a itemprop="url" href="../razor-pages/handler-methods.html">Handler Methods</a>
                </li>
                <li>
                    <a itemprop="url" href="../razor-pages/viewdata.html">ViewData</a>
                </li>
                <li>
                    <a itemprop="url" href="../razor-pages/action-results.html">Action Results</a>
                </li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../razor-pages/tag-helpers/index.html">Tag Helpers</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="../razor-pages/tag-helpers/anchor-tag-helper.html">Anchor Tag Helper</a></li>
                <li><a itemprop="url" href="../razor-pages/tag-helpers/cache-tag-helper.html">Cache Tag Helper</a></li>
                <li><a itemprop="url" href="../razor-pages/tag-helpers/distributed-cache-tag-helper.html">Distributed Cache Tag Helper</a></li>
                <li><a itemprop="url" href="../razor-pages/tag-helpers/environment-tag-helper.html">Environment Tag Helper</a></li>
                <li><a itemprop="url" href="../razor-pages/tag-helpers/form-action-tag-helper.html">Form Action Tag Helper</a></li>
                <li><a itemprop="url" href="../razor-pages/tag-helpers/form-tag-helper.html">Form Tag Helper</a></li>
                <li><a itemprop="url" href="../razor-pages/tag-helpers/image-tag-helper.html">Image Tag Helper</a></li>
                <li><a itemprop="url" href="../razor-pages/tag-helpers/input-tag-helper.html">Input Tag Helper</a></li>
                <li><a itemprop="url" href="../razor-pages/tag-helpers/label-tag-helper.html">Label Tag Helper</a></li>
                <li><a itemprop="url" href="../razor-pages/tag-helpers/link-tag-helper.html">Link Tag Helper</a></li>
                <li><a itemprop="url" href="../razor-pages/tag-helpers/option-tag-helper.html">Option Tag Helper</a></li>
                <li><a itemprop="url" href="../razor-pages/tag-helpers/partial-tag-helper.html">Partial Tag Helper</a></li>
                <li><a itemprop="url" href="../razor-pages/tag-helpers/script-tag-helper.html">Script Tag Helper</a></li>
                <li><a itemprop="url" href="../razor-pages/tag-helpers/select-tag-helper.html">Select Tag Helper</a></li>
                <li><a itemprop="url" href="../razor-pages/tag-helpers/textarea-tag-helper.html">TextArea Tag Helper</a></li>
                <li><a itemprop="url" href="../razor-pages/tag-helpers/validation-message-tag-helper.html">Validation Message Tag Helper</a></li>
                <li><a itemprop="url" href="../razor-pages/tag-helpers/validation-summary-tag-helper.html">Validation Summary Tag Helper</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../razor-pages/view-components.html">View Components</a>
        </li>
        <li>
            <a itemprop="url" href="../razor-pages/routing.html">Routing and URLs</a>
            <ul class="nav-level-two">
                <li><a href="custom-route-conventions.html">Customising Route Conventions</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../startup.html">Startup</a>
        </li>
        <li>
            <a itemprop="url" href="../configuration.html">Configuration</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="../configuration/global-error-handling.html">Global Error Handling And Logging</a></li>
                <li><a itemprop="url" href="../configuration/custom-errors.html">Custom Error Pages</a></li>
                <li><a itemprop="url" href="../configuration/https.html">Configuring HTTPS</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../middleware.html">Middleware</a>
        </li>
        <li>
            <a itemprop="url" href="../razor-pages/forms.html">Working With Forms</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="../razor-pages/forms/file-upload.html">Uploading Files in Razor Pages</a></li>
                <li><a itemprop="url" href="../razor-pages/forms/checkboxes.html">Working With Checkboxes</a></li>
                <li><a itemprop="url" href="../razor-pages/forms/select-lists.html">Select Lists in a Razor Pages Form</a></li>
                <li><a itemprop="url" href="../razor-pages/forms/radios.html">Working With Radio Buttons</a></li>
                <li><a itemprop="url" href="../security/request-verification.html">Request Verification</a></li>
            </ul>
        </li>
        <li><a itemprop="url" href="../razor-pages/validation.html">Validation</a></li>
        <li>
            <a itemprop="url" href="../razor-pages/model-binding.html">Model Binding</a>
        </li>
        <li>
            <a itemprop="url" href="../razor-pages/state-management.html">State Management</a>
        </li>
        <li>
            <a itemprop="url" href="../razor-pages/caching.html">Caching</a>
        </li>
        <li>
            <a itemprop="url" href="../identity.html">Managing Security With ASP.NET Identity</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="../identity/customising-identity.html">Customising Identity</a></li>
            </ul>
        </li>
        <li>
		<a itemprop="url" href="../razor-pages/ajax.html">Using AJAX</a>
		<ul class="nav-level-two">
			<li><a itemprop="url" href="../razor-pages/ajax/form-post.html">Posting Forms</a>    </li>
			<li><a itemprop="url" href="../razor-pages/ajax/partial-update.html">Partial Page Updates</a></li>
			<li><a itemprop="url" href="../razor-pages/ajax/upload-files.html">Uploading Files</a></li>
			<li><a itemprop="url" href="../razor-pages/ajax/unobtrusive-ajax.html">Unobtrusive AJAX</a></li>
		</ul>
	</li>
        <li>
            <a itemprop="url" href="../web-api.html">Working with JSON</a>
        </li>
        <li>
            <a itemprop="url" href="../miscellaneous/scaffolding.html">Scaffolding</a>
        </li>
        <li>
            <a itemprop="url" href="../publishing/publish-to-iis.html">Publishing To IIS</a>
        </li>
        <li>
            <a itemprop="url" href="../advanced.html">Advanced</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="areas.html">Areas</a></li>
                <li><a itemprop="url" href="custom-tag-helpers.html">Custom Tag Helpers</a></li>
                <li><a itemprop="url" href="custom-route-conventions.html">Customising Route Conventions</a></li>
                <li><a itemprop="url" href="custom-constraints.html">Custom Route Constraints</a></li>
                <li><a itemprop="url" href="route-parameter-transformers.html">Parameter Transformers For Routes</a></li>
                <li><a itemprop="url" href="dependency-injection.html">Dependency Injection</a></li>
                <li><a itemprop="url" href="../razor-pages/filters.html">Filters</a></li>
                <li><a itemprop="url" href="razor-class-library.html">Razor Class Libraries</a></li>
                <li><a itemprop="url" href="render-partial-to-string.html">Rendering A Partial View To A String</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="../table-of-contents.html">Table Of Contents</a>
        </li>
    </ul>
</nav>

            <footer>
                <p>&copy; 2019 - Learn Razor Pages.<br />All rights reserved.</p>
            </footer>
        </div>
        <!-- /.sidebar-collapse -->
    </div>

    <div id="page-wrapper">
        <div class="body-content">
            <div class="row">
                <div class="col-md-9">
                    
<div id="article">
    <h1 itemprop="headline" id="working-with-razor-class-libraries-in-asp.net-core">Working with Razor Class Libraries in ASP.NET Core</h1>
<div itemprop="articleBody"><p>Razor Class libraries (RCLs) were introduced in ASP.NET Core 2.1 as a way to package and distribute UI components to be referenced and consumed within a host application. You can see them as a fully functioning part of a web application packaged as a class library. The templated management pages for ASP.NET Identity were included as a Razor Class Library in the project template in 2.1.</p>
<p>The Identity UI RCL includes the Razor pages, filters, a stub <code>EmailService</code> class that Identity uses, and local versions of both Bootstrap 3 and 4. RCLs can also include MVC controllers and Views, and API controllers.</p>
<h2 id="creating-a-razor-class-library">Creating a Razor Class Library</h2>
<p>The following walkthrough shows how to create a Razor Class Library that could function as a content management system (CMS), perhaps a Markdown editor, although it doesn't include any real functionality. The demonstration focuses entirely on the steps needed to get a Razor Class Library up and running successfully.</p>
<ol>
<li><p>Start a new project in Visual Studio choosing the New ASP.NET Core Web Application template and name it EditorRCL</p>
</li>
<li><p>Select the Razor Class Library option, ensuring that the version is ASP.NET Core 2.1 or higher:</p>
<p><img src="../../www.mikesdotnetting.com/images/11-10-2018-08-40-14.png" class="img-fluid" alt="Razor Class Library" /></p>
<p><img src="../../www.mikesdotnetting.com/images/11-10-2018-08-42-43.png" class="img-fluid" alt="Razor Class Library" /></p>
</li>
<li><p>Build (or wait for VS to perform a restore) to get rid of warnings and then rename the <em>MyFeature</em> folder to <em>Editor</em> and delete <em>Page1.cshtml</em> and its PageModel class file</p>
</li>
<li><p>Add a Razor Page named <em>Index.cshtml</em> to the <em>Pages</em> folder in the <em>Editor</em> area with the following code:</p>
<pre><code class="language-html">@page
@model EditorRCL.Areas.Editor.Pages.IndexModel
@{

}
&lt;h1&gt;RCL Editor&lt;/h1&gt;
</code></pre>
<p><img src="../../www.mikesdotnetting.com/images/2018-10-14_16-38-13.png" class="img-fluid" alt="Razor Class Library" /></p>
</li>
<li><p>Right click on the solution in Soultion Explorer and choose <strong>Add</strong> » <strong>New Project</strong>, and select ASP.NET Core Web Application. Name it <strong>EditorHost</strong> and then choose <strong>Web Application</strong>. The Razor Pages application that gets generated will provide the test environment for the Razor class library.</p>
</li>
<li><p>Add a reference to the EditorRCL from within the EditorHost site. You can do this by right-clicking on EditorHost project in Solution Explorer and choosing <strong>Add</strong> » <strong>Reference</strong>, or by modifying the <em>EditorHost.csproj</em> file to include a <code>ProjectReference</code> entry so that it looks like this:</p>
<pre><code class="language-xml">&lt;Project Sdk=&quot;Microsoft.NET.Sdk.Web&quot;&gt;

  &lt;PropertyGroup&gt;
    &lt;TargetFramework&gt;netcoreapp2.1&lt;/TargetFramework&gt;
  &lt;/PropertyGroup&gt;

  &lt;ItemGroup&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.App&quot; /&gt;
  &lt;/ItemGroup&gt;

  &lt;ItemGroup&gt;
    &lt;ProjectReference Include=&quot;..\EditorRCL\EditorRCL.csproj&quot; /&gt;
  &lt;/ItemGroup&gt;

&lt;/Project&gt;
</code></pre>
</li>
<li><p>Make sure that EditorHost is set as the startup project:</p>
<p><img src="../../www.mikesdotnetting.com/images/2018-10-14_17-19-50.png" class="img-fluid" alt="Razor Class Library" /></p>
<p>and run the application. You should get the default template home page. Add /editor to the URL. The result should look like this:</p>
<p><img src="../../www.mikesdotnetting.com/images/2018-10-15_07-46-45.png" class="img-fluid" alt="Razor Class Library" /></p>
<p>If it does, then the Razor class library has been referenced correctly and is working.</p>
<p>However, the output is totally unstyled. If you look at the source for the page, it consists of a single line of HTML: <code>&lt;h1&gt;RCL Editor&lt;/h1&gt;</code>. The page needs a Layout.</p>
</li>
</ol>
<h2 id="adding-a-layout">Adding a Layout</h2>
<ol>
<li><p>Add a new folder named Shared to the Pages folder in the EditorRCL project.</p>
</li>
<li><p>Add a Razor Layout named _Layout.cshtml to this folder with the following code:</p>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot; /&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt;
    &lt;title&gt;@ViewData[&quot;Title&quot;]&lt;/title&gt;

    &lt;environment include=&quot;Development&quot;&gt;
        &lt;link rel=&quot;stylesheet&quot; href=&quot;~/css/bootstrap.css&quot; /&gt;
        &lt;link rel=&quot;stylesheet&quot; href=&quot;~/css/site.css&quot; /&gt;
    &lt;/environment&gt;
    &lt;environment exclude=&quot;Development&quot;&gt;
        &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css&quot;
          asp-fallback-href=&quot;~/css/bootstrap.min.css&quot;
          asp-fallback-test-class=&quot;sr-only&quot; asp-fallback-test-property=&quot;position&quot; asp-fallback-test-value=&quot;absolute&quot; /&gt;
        &lt;link rel=&quot;stylesheet&quot; href=&quot;~/css/site.css&quot; asp-append-version=&quot;true&quot; /&gt;
    &lt;/environment&gt;
    &lt;link href=&quot;https://fonts.googleapis.com/icon?family=Material+Icons&quot; rel=&quot;stylesheet&quot;&gt;

&lt;/head&gt;
&lt;body&gt;

    &lt;div class=&quot;container&quot;&gt;
        &lt;main role=&quot;main&quot; class=&quot;pb-3&quot;&gt;
            @RenderBody()
        &lt;/main&gt;
    &lt;/div&gt;

    &lt;footer class=&quot;border-top footer text-muted&quot;&gt;
        &lt;div class=&quot;container&quot;&gt;
            &amp;copy; 2018 
        &lt;/div&gt;
    &lt;/footer&gt;

    &lt;environment include=&quot;Development&quot;&gt;
        &lt;script src=&quot;~/js/jquery.js&quot;&gt;&lt;/script&gt;
        &lt;script src=&quot;~/js/bootstrap.bundle.js&quot;&gt;&lt;/script&gt;
        &lt;script src=&quot;~/js/site.js&quot; asp-append-version=&quot;true&quot;&gt;&lt;/script&gt;
    &lt;/environment&gt;
    &lt;environment exclude=&quot;Development&quot;&gt;
        &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js&quot;
            asp-fallback-src=&quot;~/js/jquery.min.js&quot;
            asp-fallback-test=&quot;window.jQuery&quot;
            crossorigin=&quot;anonymous&quot;
            integrity=&quot;sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=&quot;&gt;
        &lt;/script&gt;
        &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.bundle.min.js&quot;
            asp-fallback-src=&quot;~/js/bootstrap.bundle.min.js&quot;
            asp-fallback-test=&quot;window.jQuery &amp;&amp; window.jQuery.fn &amp;&amp; window.jQuery.fn.modal&quot;
            crossorigin=&quot;anonymous&quot;
            integrity=&quot;sha256-E/V4cWE4qvAeO5MOhjtGtqDzPndRO1LBk8lJ/PR7CA4=&quot;&gt;
        &lt;/script&gt;
        &lt;script src=&quot;~/js/site.min.js&quot; asp-append-version=&quot;true&quot;&gt;&lt;/script&gt;
    &lt;/environment&gt;

    @RenderSection(&quot;Scripts&quot;, required: false)
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
</li>
<li><p>Add a new Razor View Start file to the Pages folder in the EditorRCL project named _<em>ViewStart.cshtml</em>. The default template should contain the following code:</p>
<pre><code class="language-csharp">@{
    Layout = &quot;_Layout&quot;;
}
</code></pre>
</li>
<li><p>Now if you run the application, it looks like the Layout page is working:</p>
<p><img src="../../www.mikesdotnetting.com/images/15-10-2018-08-39-52.png" class="img-fluid" alt="Razor Class Library" /></p>
<p>And it is working - to an extent. It is being referenced correctly from the Razor Page, but if you look at the source code, you can see environment tags and other tag helper attributes:</p>
<p><img src="../../www.mikesdotnetting.com/images/15-10-2018-08-45-18.png" class="img-fluid" alt="Razor Class Library" /></p>
<p>The Tag Helpers are not being processed. They look like they might be, because Bootstrap is being applied. However the CSS file that should be used in development mode is supposed to be located in a folder named css, which doesn't exist yet. The rendered environment tags are being ignored by the browser and the CDN version of Bootstrap is being used instead.</p>
</li>
<li><p>Tag helpers are an opt-in feature, so we shall opt in. Add a new Razor View Imports file to the Pages folder in the EditorRCL project. Add the following code to the file:</p>
<pre><code class="language-csharp">@namespace EditorRCL.Areas.Editor.Pages
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
</code></pre>
<p>Now when you run the page, you will find that no Bootstrap styles are being applied, and the browser cannot find any css or js files being referenced in Development mode:</p>
<p><img src="../../www.mikesdotnetting.com/images/15-10-2018-09-07-16.png" class="img-fluid" alt="Razor Class Library" /></p>
</li>
</ol>
<h2 id="adding-static-resources">Adding Static Resources</h2>
<p>The final step involves adding local copies of script and style files to the class library and then configuring them to work.</p>
<ol>
<li><p>Create a folder named resources in the root of the EditorRCL project (at the same level as the Areas folder) ands within that add two further folders named css and js:</p>
<p><img src="../../www.mikesdotnetting.com/images/16-10-2018-14-04-35.png" class="img-fluid" alt="Razor Class Library" /></p>
</li>
<li><p>Add Bootstrap 4 and Jquery files to the folders. I copied these across from a Razor Pages 2.2 project template (created using the <code>dotnet new razor</code> command with the preview of .NET Core 2.2 SDK installed). Alternatively you can obtain them yourself using npm, Nuget or by going to the project sites and obtaining the files. You should also create a <em>site.css</em> file and a <em>site.js</em> file and add those to the relevant folders:</p>
<p><img src="../../www.mikesdotnetting.com/images/16-10-2018-14-09-31.png" class="img-fluid" alt="Razor Class Library" /></p>
<p>Static files in a standalone class library cannot be browsed like those in a web application. They need to be included in the resulting compiled assembly as embedded resources. So the next step is to alter the <em>EditorRCL.csproj</em> file to specify that the contents of the resources folder should be included as an embedded resource, include the <code>Microsoft.Extensions.FileProviders.Embedded</code> package and <code>Microsoft.AspNetCore.StaticFiles</code>, and importantly, to specify that a manifest is generated for the embedded resources:</p>
<pre><code class="language-xml">&lt;Project Sdk=&quot;Microsoft.NET.Sdk.Razor&quot;&gt;

  &lt;PropertyGroup&gt;
    &lt;TargetFramework&gt;netstandard2.0&lt;/TargetFramework&gt;
    &lt;GenerateEmbeddedFilesManifest&gt;true&lt;/GenerateEmbeddedFilesManifest&gt;
  &lt;/PropertyGroup&gt;

  &lt;ItemGroup&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Mvc&quot; Version=&quot;2.1.2&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.Extensions.FileProviders.Embedded&quot; Version=&quot;2.1.1&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.StaticFiles&quot; Version=&quot;2.1.1&quot; /&gt;
  &lt;/ItemGroup&gt;

  &lt;ItemGroup&gt;
    &lt;EmbeddedResource Include=&quot;resources\**\*&quot; /&gt;
  &lt;/ItemGroup&gt;

&lt;/Project&gt;
</code></pre>
</li>
<li><p>Next, borrowing code from the IdentityUI source, add the following class to the EditorRCL project:</p>
<pre><code class="language-csharp">using Microsoft.AspNetCore.Builder;
using Microsoft.AspNetCore.Hosting;
using Microsoft.AspNetCore.StaticFiles;
using Microsoft.Extensions.FileProviders;
using Microsoft.Extensions.Options;
using System;

namespace EditorRCL
{
    internal class EditorRCLConfigureOptions : IPostConfigureOptions&lt;StaticFileOptions&gt;
    {
        private readonly IHostingEnvironment _environment;

        public EditorRCLConfigureOptions(IHostingEnvironment environment)
        {
            _environment = environment;
        }

        public void PostConfigure(string name, StaticFileOptions options)
        {

            // Basic initialization in case the options weren't initialized by any other component
            options.ContentTypeProvider = options.ContentTypeProvider ?? new FileExtensionContentTypeProvider();

            if (options.FileProvider == null &amp;&amp; _environment.WebRootFileProvider == null)
            {
                throw new InvalidOperationException(&quot;Missing FileProvider.&quot;);
            }

            options.FileProvider = options.FileProvider ?? _environment.WebRootFileProvider;


            // Add our provider
            var filesProvider = new ManifestEmbeddedFileProvider(GetType().Assembly, &quot;resources&quot;);
            options.FileProvider = new CompositeFileProvider(options.FileProvider, filesProvider);
        }
    }
}
</code></pre>
<p>This code creates an additional <code>FileProvider</code>, pointing to the <em>resources</em> folder, and adds it to those that retrieve static files.</p>
</li>
<li><p>Add the following extension method to simplify applying the configuration in the Startup class <code>ConfigureService</code> method:</p>
<pre><code class="language-csharp">using Microsoft.Extensions.DependencyInjection;

namespace EditorRCL
{
    public static class EditorRCLServiceCollectionExtensions
    {
        public static void AddEditor(this IServiceCollection services)
        {
            services.ConfigureOptions(typeof(EditorRCLConfigureOptions));
        }
    }
}
</code></pre>
</li>
<li><p>Modify the ConfigureServices method in the EditorHost application's Startup class to include a call to the extension method above (line 10 below):</p>
<pre><code class="language-csharp">public void ConfigureServices(IServiceCollection services)
{
    services.Configure&lt;CookiePolicyOptions&gt;(options =&gt;
    {
        // This lambda determines whether user consent for non-essential cookies is needed for a given request.
        options.CheckConsentNeeded = context =&gt; true;
        options.MinimumSameSitePolicy = SameSiteMode.None;
    });

    services.AddEditor();
    services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_1);
}
</code></pre>
<p>Now when you run the application, you can see that the embedded resources are retrieved successfully:</p>
<p><img src="../../www.mikesdotnetting.com/images/16-10-2018-13-51-51.png" class="img-fluid" alt="Razor Class Library" /></p>
</li>
</ol>
<h2 id="overriding-class-library-content">Overriding Class Library Content</h2>
<p>The consuming application can override any aspect of the Razor Class Library by emulating the area folder structure of the class library. Based on the example above, you can replace the Index page within the RCL by creating the following structure within the EditorHost project:</p>
<pre><code>Areas
    Editor
        Pages
            Index.cshtml
</code></pre>
<p><img src="../images/22-10-2018-07-59-23.png" class="img-fluid" alt="Override Razor Class Library" /></p>
<p>The <em>ViewStart</em> file within the RCL will still be executed, and the layout specified in that will be applied. If you want to override the layout, you need to provide one that conflicts with the search paths which in this case are:</p>
<pre><code>/Areas/Editor/Pages/
/Areas/Editor/Pages/Shared/
/Areas/Editor/Views/Shared/
/Pages/Shared/
/Views/Shared/
</code></pre>
<p>The RCL version of the layout is found in <code>/Areas/Editor/Pages/Shared/</code>, so your override version should be placed in that location or any (just one here) location searched prior to that. Alternatively, you can reference a custom layout directly in the override <em>Index</em> page using a full relative path.</p>

</div>
</div>
<section id="file-meta">
    <span class="file-meta-label">Last updated:</span> <span itemprop="dateModified">22/10/2018 08:24:59</span><br />
</section>

                </div>
                <div class="col-md-3 right-col">
                    
                            <script>
                        (function() {
                            var cx = 'partner-pub-8046723421340367:6108194070';
                            var gcse = document.createElement('script');
                            gcse.type = 'text/javascript';
                            gcse.async = true;
                            gcse.src = '../../cse.google.com/cse07b6.html?cx=' + cx;
                            var s = document.getElementsByTagName('script')[0];
                            s.parentNode.insertBefore(gcse, s);
                        })();
                            </script>
                        <gcse:searchbox-only></gcse:searchbox-only>
                    
                    <div id="doc-outline" class="doc-outline well">
                            <h3 class="doc-outline">On this page</h3>
                            <nav class="doc-outline">
                                <ul>
                                        <li><a itemprop="url" href="#working-with-razor-class-libraries-in-asp.net-core" class="page-scroll">Working with Razor Class Libraries in ASP.NET Core</a></li>
                                        <li><a itemprop="url" href="#creating-a-razor-class-library" class="page-scroll">Creating a Razor Class Library</a></li>
                                        <li><a itemprop="url" href="#adding-a-layout" class="page-scroll">Adding a Layout</a></li>
                                        <li><a itemprop="url" href="#adding-static-resources" class="page-scroll">Adding Static Resources</a></li>
                                        <li><a itemprop="url" href="#overriding-class-library-content" class="page-scroll">Overriding Class Library Content</a></li>
                                </ul>
                            </nav>

                    </div>
                    <div class="rectangle">
                        
                                <script async src="../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
                            <!-- EF Core Rectangle -->
                            <ins class="adsbygoogle"
                                 style="display:inline-block;width:300px;height:250px"
                                 data-ad-client="ca-pub-8046723421340367"
                                 data-ad-slot="7622896857"></ins>
                            <script>
                                (adsbygoogle = window.adsbygoogle || []).push({});
                            </script>
                        
                    </div>
                    <div class="doc-outline well">
                        <h3 class="doc-outline">Latest Updates</h3>
                        <nav class="doc-outline">
                            <ul>
                                    <li><a itemprop="url" href="../razor-pages/tutorial/bakery/migration.html">Creating A Migration</a></li>
                                    <li><a itemprop="url" href="../razor-pages/tutorial/bakery/create-model.html">Working With A Model</a></li>
                                    <li><a itemprop="url" href="../razor-pages/routing.html">Routing in Razor Pages</a></li>
                                    <li><a itemprop="url" href="../razor-pages/tutorial/bakery/working-with-data.html">Working With Data</a></li>
                                    <li><a itemprop="url" href="../razor-pages/tutorial/bakery/new-page.html">Adding a New Page</a></li>
                                    <li><a itemprop="url" href="../razor-pages/tutorial/bakery.html">Creating an Application</a></li>
                            </ul>
                        </nav>
                    </div>
                    <div class="skyscraper">
                        
                                <script async src="../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
                            <!-- EF Core Skyscraper -->
                            <ins class="adsbygoogle"
                                 style="display:inline-block;width:300px;height:600px"
                                 data-ad-client="ca-pub-8046723421340367"
                                 data-ad-slot="4239197376"></ins>
                            <script>
                                (adsbygoogle = window.adsbygoogle || []).push({});
                            </script>
                        
                    </div>
                    <footer>
                        <p>&copy; 2019 - Learn Razor Pages.<br />All rights reserved.</p>
                    </footer>
                </div>
            </div>
        </div>
        <a href="#page-top" id="back-to-top" class="page-scroll" title="Back to top"><i class="fas fa-arrow-alt-circle-up"></i></a>
    </div>
    <div class="cookie-box" id="cookie-warning">
        <div class="cookie-box-contents" id="learnrazorpages">This site uses cookies to analyse traffic, remember your preferences, and optimise your experience.</div>
        <div class="cookie-box-buttons"><a href="../privacy.html" class="cookie-button">Learn more</a><a href="#" class="cookie-button" id="cookie-close">Close</a></div>
    </div>
    <script src="../../ajax.aspnetcdn.com/ajax/jquery/jquery-2.2.0.min.js"></script>
    <script src="../../ajax.aspnetcdn.com/ajax/bootstrap/3.3.6/bootstrap.min.js"></script>
    <script src="../../code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    
    <script src="../../cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
    <script src="../js/site59f2.js?v=gJZRD7PDF8oEm1Xb0uhLZcpf7Vs12fGO-q0DErBSF_Y"></script>
    
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-1264020-21"></script>
        <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-1264020-21');
        </script>
    
    
</body>

<!-- Mirrored from www.learnrazorpages.com/advanced/razor-class-library by HTTrack Website Copier/3.x [XR&CO'2005], Fri, 07 Jun 2019 04:22:01 GMT -->
</html>
