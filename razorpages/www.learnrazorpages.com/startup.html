<!DOCTYPE html>
<html>

<!-- Mirrored from www.learnrazorpages.com/startup by HTTrack Website Copier/3.x [XR&CO'2005], Fri, 07 Jun 2019 04:13:08 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="The Startup Class in Razor Pages is the place where you configure the services that your application needs and its request pipeline" />
    <meta name="google-site-verification" content="MpV6gEoCh9OASgnoi656klwnlkni3_qOenITGlxBrjc" />
    <title>The Startup Class in Razor Pages | Learn Razor Pages</title>
    <link rel="canonical" href="startup.html" />
    <link rel="stylesheet" href="../ajax.aspnetcdn.com/ajax/bootstrap/3.3.6/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,600,600i|Roboto:300i,500,700" />
    <link rel="stylesheet" href="../use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
    <script src="../cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
    <link rel="stylesheet" href="css/site8249.css?v=PCA7f9VuZUscxMwrePJfyFKXCF9mh2dMpXEDQU8oP3o" />
    <link rel="stylesheet" href="css/rp14c5.css?v=ZxkVB0StHjR5-UMElJII7nwWe6Wmc6_qgJ97GsY4yNw" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <script async src="../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
        <script>
            (adsbygoogle = window.adsbygoogle || []).push({
                google_ad_client: "ca-pub-8046723421340367",
                enable_page_level_ads: true
            });
        </script>
</head>
<body id="page-top">
    <div class="navbar navbar-default navbar-static-top">
        <div>
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <div class="navbar-brand">
                    <i class="fas fa-graduation-cap"></i> <a href="index.html">Learn Razor Pages</a>
                    <br />
                    <span class="byline">Your guide to using ASP.NET Core Razor Pages</span>
                </div>
                <div class="banner">
                    
                        <script async src="../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
                        <!-- EF Core Leaderboard -->
                        <ins class="adsbygoogle"
                             style="display:inline-block;width:728px;height:90px"
                             data-ad-client="ca-pub-8046723421340367"
                             data-ad-slot="1832525889"></ins>
                        <script>
                        (adsbygoogle = window.adsbygoogle || []).push({});
                        </script>                    
                </div>
            </div>

        </div>
    </div>
    <div class="navbar-default sidebar" role="navigation">
        <div class="sidebar-nav navbar-collapse">
            <nav class="main-nav" itemscope itemtype="http://schema.org/SiteNavigationElement">
    <ul class="nav nav-level-one" id="side-menu">
        <li>
            <a itemprop="url" href="index.html">Home</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="first-look.html">A First Look</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="asp-net-core.html">ASP.NET Core</a>
        </li>
        <li><a itemprop="url" href="razor-pages/tutorial/bakery.html">Tutorials</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="razor-pages/tutorial/bakery.html">The Bakery</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="razor-pages.html">Razor Page Files</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="razor-pages/files/index.html">Razor Files</a></li>
                <li><a itemprop="url" href="razor-pages/partial-pages.html">Partial Pages</a></li>
                <li><a itemprop="url" href="razor-pages/files/layout.html">Layout Files</a></li>
                <li><a itemprop="url" href="razor-pages/files/viewimports.html">ViewImports File</a></li>
                <li><a itemprop="url" href="razor-pages/files/viewstart.html">ViewStart File</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="razor-syntax.html">Razor Syntax</a>
        </li>
        <li>
            <a itemprop="url" href="razor-pages/pagemodel.html">Page Models</a>
            <ul class="nav-level-two">
                <li>
                    <a itemprop="url" href="razor-pages/handler-methods.html">Handler Methods</a>
                </li>
                <li>
                    <a itemprop="url" href="razor-pages/viewdata.html">ViewData</a>
                </li>
                <li>
                    <a itemprop="url" href="razor-pages/action-results.html">Action Results</a>
                </li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="razor-pages/tag-helpers/index.html">Tag Helpers</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="razor-pages/tag-helpers/anchor-tag-helper.html">Anchor Tag Helper</a></li>
                <li><a itemprop="url" href="razor-pages/tag-helpers/cache-tag-helper.html">Cache Tag Helper</a></li>
                <li><a itemprop="url" href="razor-pages/tag-helpers/distributed-cache-tag-helper.html">Distributed Cache Tag Helper</a></li>
                <li><a itemprop="url" href="razor-pages/tag-helpers/environment-tag-helper.html">Environment Tag Helper</a></li>
                <li><a itemprop="url" href="razor-pages/tag-helpers/form-action-tag-helper.html">Form Action Tag Helper</a></li>
                <li><a itemprop="url" href="razor-pages/tag-helpers/form-tag-helper.html">Form Tag Helper</a></li>
                <li><a itemprop="url" href="razor-pages/tag-helpers/image-tag-helper.html">Image Tag Helper</a></li>
                <li><a itemprop="url" href="razor-pages/tag-helpers/input-tag-helper.html">Input Tag Helper</a></li>
                <li><a itemprop="url" href="razor-pages/tag-helpers/label-tag-helper.html">Label Tag Helper</a></li>
                <li><a itemprop="url" href="razor-pages/tag-helpers/link-tag-helper.html">Link Tag Helper</a></li>
                <li><a itemprop="url" href="razor-pages/tag-helpers/option-tag-helper.html">Option Tag Helper</a></li>
                <li><a itemprop="url" href="razor-pages/tag-helpers/partial-tag-helper.html">Partial Tag Helper</a></li>
                <li><a itemprop="url" href="razor-pages/tag-helpers/script-tag-helper.html">Script Tag Helper</a></li>
                <li><a itemprop="url" href="razor-pages/tag-helpers/select-tag-helper.html">Select Tag Helper</a></li>
                <li><a itemprop="url" href="razor-pages/tag-helpers/textarea-tag-helper.html">TextArea Tag Helper</a></li>
                <li><a itemprop="url" href="razor-pages/tag-helpers/validation-message-tag-helper.html">Validation Message Tag Helper</a></li>
                <li><a itemprop="url" href="razor-pages/tag-helpers/validation-summary-tag-helper.html">Validation Summary Tag Helper</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="razor-pages/view-components.html">View Components</a>
        </li>
        <li>
            <a itemprop="url" href="razor-pages/routing.html">Routing and URLs</a>
            <ul class="nav-level-two">
                <li><a href="advanced/custom-route-conventions.html">Customising Route Conventions</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="startup.html">Startup</a>
        </li>
        <li>
            <a itemprop="url" href="configuration.html">Configuration</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="configuration/global-error-handling.html">Global Error Handling And Logging</a></li>
                <li><a itemprop="url" href="configuration/custom-errors.html">Custom Error Pages</a></li>
                <li><a itemprop="url" href="configuration/https.html">Configuring HTTPS</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="middleware.html">Middleware</a>
        </li>
        <li>
            <a itemprop="url" href="razor-pages/forms.html">Working With Forms</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="razor-pages/forms/file-upload.html">Uploading Files in Razor Pages</a></li>
                <li><a itemprop="url" href="razor-pages/forms/checkboxes.html">Working With Checkboxes</a></li>
                <li><a itemprop="url" href="razor-pages/forms/select-lists.html">Select Lists in a Razor Pages Form</a></li>
                <li><a itemprop="url" href="razor-pages/forms/radios.html">Working With Radio Buttons</a></li>
                <li><a itemprop="url" href="security/request-verification.html">Request Verification</a></li>
            </ul>
        </li>
        <li><a itemprop="url" href="razor-pages/validation.html">Validation</a></li>
        <li>
            <a itemprop="url" href="razor-pages/model-binding.html">Model Binding</a>
        </li>
        <li>
            <a itemprop="url" href="razor-pages/state-management.html">State Management</a>
        </li>
        <li>
            <a itemprop="url" href="razor-pages/caching.html">Caching</a>
        </li>
        <li>
            <a itemprop="url" href="identity.html">Managing Security With ASP.NET Identity</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="identity/customising-identity.html">Customising Identity</a></li>
            </ul>
        </li>
        <li>
		<a itemprop="url" href="razor-pages/ajax.html">Using AJAX</a>
		<ul class="nav-level-two">
			<li><a itemprop="url" href="razor-pages/ajax/form-post.html">Posting Forms</a>    </li>
			<li><a itemprop="url" href="razor-pages/ajax/partial-update.html">Partial Page Updates</a></li>
			<li><a itemprop="url" href="razor-pages/ajax/upload-files.html">Uploading Files</a></li>
			<li><a itemprop="url" href="razor-pages/ajax/unobtrusive-ajax.html">Unobtrusive AJAX</a></li>
		</ul>
	</li>
        <li>
            <a itemprop="url" href="web-api.html">Working with JSON</a>
        </li>
        <li>
            <a itemprop="url" href="miscellaneous/scaffolding.html">Scaffolding</a>
        </li>
        <li>
            <a itemprop="url" href="publishing/publish-to-iis.html">Publishing To IIS</a>
        </li>
        <li>
            <a itemprop="url" href="advanced.html">Advanced</a>
            <ul class="nav-level-two">
                <li><a itemprop="url" href="advanced/areas.html">Areas</a></li>
                <li><a itemprop="url" href="advanced/custom-tag-helpers.html">Custom Tag Helpers</a></li>
                <li><a itemprop="url" href="advanced/custom-route-conventions.html">Customising Route Conventions</a></li>
                <li><a itemprop="url" href="advanced/custom-constraints.html">Custom Route Constraints</a></li>
                <li><a itemprop="url" href="advanced/route-parameter-transformers.html">Parameter Transformers For Routes</a></li>
                <li><a itemprop="url" href="advanced/dependency-injection.html">Dependency Injection</a></li>
                <li><a itemprop="url" href="razor-pages/filters.html">Filters</a></li>
                <li><a itemprop="url" href="advanced/razor-class-library.html">Razor Class Libraries</a></li>
                <li><a itemprop="url" href="advanced/render-partial-to-string.html">Rendering A Partial View To A String</a></li>
            </ul>
        </li>
        <li>
            <a itemprop="url" href="table-of-contents.html">Table Of Contents</a>
        </li>
    </ul>
</nav>

            <footer>
                <p>&copy; 2019 - Learn Razor Pages.<br />All rights reserved.</p>
            </footer>
        </div>
        <!-- /.sidebar-collapse -->
    </div>

    <div id="page-wrapper">
        <div class="body-content">
            <div class="row">
                <div class="col-md-9">
                    
<div id="article">
    <h1 itemprop="headline" id="the-startup-class">The Startup Class</h1>
<div itemprop="articleBody"><p>ASP.NET Core applications are designed to be modular, in that the developer only includes features and services that they need. Every .NET Core application requires a startup class where the application's features and services are configured. By default, the name of this class is <em>Startup</em>, but it can be named anything.</p>
<p>The startup class is found in the <em>Startup.cs</em> file that's generated as part of the default template. It has a <code>Configure</code> method which is required and a <code>ConfigureServices</code> method, which is optional. The <code>Configure</code> method is used for configuring the request pipeline and the <code>ConfigureServices</code> method is used to make services available to the application.</p>
<div class="alert alert-info"><h2 id="the-request-pipeline">The Request Pipeline</h2>
<p>When requests are made to a web application, they need to be processed in some way. A number of considerations need to be taken into account. Where should the request be directed or routed to? Should it log details of the request? Should the application simply return the content of a file?  Should it compress the response? What should happen if an exception is encountered while the request is being processed? Is the person making the request actually allowed to access the resource they have requested? How should cookies or other request-related data be handled?</p>
<p>Each of these processing actions are performed by separate components. The term used to describe these components is  <a href="middleware.html">Middleware</a>. Together, they form the request pipeline.</p>
</div>
<h2 id="the-configure-method">The Configure Method</h2>
<p>Here is the template version of the <code>Configure</code> method:</p>
<pre><code class="language-csharp">public void Configure(IApplicationBuilder app, IHostingEnvironment env)
{
	if (env.IsDevelopment())
	{
		app.UseDeveloperExceptionPage();
	}
	else
	{
		app.UseExceptionHandler(&quot;/Error&quot;);
	}

	app.UseStaticFiles();

	app.UseMvc(routes =&gt;
	{
		routes.MapRoute(
			name: &quot;default&quot;,
			template: &quot;{controller=Home}/{action=Index}/{id?}&quot;);
	});
}
</code></pre>
<p>The parameters passed to the method are <code>IApplicationBuilder</code> and <code>IHostingEnvironment</code>. No parameters are actually required, but the <code>IApplicationBuilder</code> is the component that configures the request pipeline by adding middleware to it. <code>IHostingEnvironment</code> provides information about the environment that the application is currently running in.</p>
<p>This version of the <code>Configure</code> method examines the current environment (set via an environment variable called ASPNETCORE_ENVIRONMENT) to see if it is <em>Development</em>. If it is, middleware is added to the request pipeline that enables detailed error messages to be rendered to the browser if the application raises exceptions when it is running. The middleware is added using an extension method (in this case <code>UseDeveloperExceptionPage()</code>) on <code>IApplicationBuilder</code>, which is the recommended way to construct the request pipeline. If the enviroment is not <em>Development</em> (e.g is it <em>Production</em>), a middleware component is added that logs details about failed requests and redirects to a page named <em>Error</em>. This is the recommended behaviour for a live site, where the <em>Error</em> page displays a more user-friendly message rather than a stack trace.</p>
<p>Middleware is then added that enables the serving of static files (images, scripts, style sheets, PDF files etc), and then the MVC framework is added to the application. This is essential because Razor Pages is part of MVC. The default template sets up a default route for MVC requests, which can be dispensed with if you don't plan on building a Razor Pages/MVC/Web API hybrid application. So if you prefer, you can alter the <code>UseMvc</code> method as follows:</p>
<pre><code class="language-csharp">app.UseMvc();
</code></pre>
<h2 id="the-configureservices-method">The ConfigureServices Method</h2>
<p>ASP.NET Core makes extensive use of <a href="advanced/dependency-injection.html">dependency injection</a> (DI) - a technique that facilitates loose coupling of code. Components, or &quot;services&quot; are represented as abstractions, typically interfaces, as you have already seen in the <code>Configure</code> method with <code>IApplicationBuilder</code>. In DI, each abstraction is paired with an implementation (or &quot;concrete&quot;) type. This pairing is stored in a dictionary-like structure so that when an abstraction is passed as a parameter to a method (particularly a constructor), the implementation type is instantiated and passed in by the DI container. The primary purpose of the <code>ConfigureServices</code> method is as a place to register implementation types for services that are needed by the application. It is also used to configure any options related to those services.</p>
<p>If it has been added to the <code>Startup</code> class, the <code>ConfigureServices</code> method is called before the <code>Configure</code> method. That makes sense, because the <code>Configure</code> method may attempt to reference services which need to be registered beforehand so that they can be resolved. This is the case with the default template where MVC is registered:</p>
<pre><code class="language-csharp">public void ConfigureServices(IServiceCollection services)
{
	services.AddMvc();
}
</code></pre>
<p>The <code>AddMvc</code> method is a wrapper for adding a substantial number of components to the service collection, including routing, model binding, caching, view engines and other components that MVC (and therefore Razor Pages) requires. It also provides a place where options relating to the services can be configured. For example, The <code>AddMvc</code> method returns an <code>IMvcBuilder</code>, which offers a wide range of configuration options:</p>
<p><img src="images/01-08-2017-13-57-55.png" class="img-fluid" alt="Mvc Options" /></p>
<p>If you want to configure the root folder for Razor Pages to be something other than the default <em>Pages</em>, this is where you would do that:</p>
<pre><code class="language-csharp">public void ConfigureServices(IServiceCollection services)
{
    services.AddMvc().AddRazorPagesOptions(options =&gt;
    {
        options.RootDirectory = &quot;/Content&quot;;
    });
}
</code></pre>
<h3 id="compatibility-version">Compatibility Version</h3>
<p>A new setting, <em>Compatibility Version</em> was introduced in ASP.NET Core 2.1. This allows you to opt into or out of new features released as part of future versions which might break existing behaviour. For example, <a href="advanced/areas.html">Areas</a> was introduced in 2.1. This may have an adverse effect on the routing in some Razor Pages applications built using the default configuration found in version 2.0, which are subsequently upgraded to version 2.1 or later. The team behind ASP.NET Core decided that areas (and other features) should be enabled by default going forward.</p>
<p>The <code>SetCompatibilityVersion</code> method enables you to determine the version of the framework that your application should be compatible with, in respect of these default behaviours. It takes an enumeration specifying the framework version. All new applications built using the standard template that target version 2.1 have the compatibility version set to <code>CompatibilityVersion.Version_2_1</code>.</p>
<pre><code class="language-csharp">services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_1);
</code></pre>
<p>Even with this setting, you can selectively disable default behaviours:</p>
<pre><code class="language-csharp">// disable areas, but keep the other new default behaviours
services.AddMvc().AddRazorPagesOptions(options =&gt; {
    options.AllowAreas = false;
}).SetCompatibilityVersion(CompatibilityVersion.Version_2_1);
</code></pre>
<p>Alternatively, you can keep the version 2.0 defaults - either by specifying <code>CompatibilityVersion.Version_2_0</code> or omitting the method - and then selectively enable new features:</p>
<pre><code class="language-csharp">// don't introduce the new behaviours, but allow me to use areas
services.AddMvc().AddRazorPagesOptions(options =&gt; {
    options.AllowAreas = true;
}).SetCompatibilityVersion(CompatibilityVersion.Version_2_0);
</code></pre>

</div>
</div>
<section id="file-meta">
    <span class="file-meta-label">Last updated:</span> <span itemprop="dateModified">07/09/2018 22:12:16</span><br />
</section>

                </div>
                <div class="col-md-3 right-col">
                    
                            <script>
                        (function() {
                            var cx = 'partner-pub-8046723421340367:6108194070';
                            var gcse = document.createElement('script');
                            gcse.type = 'text/javascript';
                            gcse.async = true;
                            gcse.src = '../cse.google.com/cse07b6.html?cx=' + cx;
                            var s = document.getElementsByTagName('script')[0];
                            s.parentNode.insertBefore(gcse, s);
                        })();
                            </script>
                        <gcse:searchbox-only></gcse:searchbox-only>
                    
                    <div id="doc-outline" class="doc-outline well">
                            <h3 class="doc-outline">On this page</h3>
                            <nav class="doc-outline">
                                <ul>
                                        <li><a itemprop="url" href="#the-startup-class" class="page-scroll">The Startup Class</a></li>
                                        <li><a itemprop="url" href="#the-request-pipeline" class="page-scroll">The Request Pipeline</a></li>
                                        <li><a itemprop="url" href="#the-configure-method" class="page-scroll">The Configure Method</a></li>
                                        <li><a itemprop="url" href="#the-configureservices-method" class="page-scroll">The ConfigureServices Method</a></li>
                                        <li><a itemprop="url" href="#compatibility-version" class="page-scroll">Compatibility Version</a></li>
                                </ul>
                            </nav>

                    </div>
                    <div class="rectangle">
                        
                                <script async src="../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
                            <!-- EF Core Rectangle -->
                            <ins class="adsbygoogle"
                                 style="display:inline-block;width:300px;height:250px"
                                 data-ad-client="ca-pub-8046723421340367"
                                 data-ad-slot="7622896857"></ins>
                            <script>
                                (adsbygoogle = window.adsbygoogle || []).push({});
                            </script>
                        
                    </div>
                    <div class="doc-outline well">
                        <h3 class="doc-outline">Latest Updates</h3>
                        <nav class="doc-outline">
                            <ul>
                                    <li><a itemprop="url" href="razor-pages/tutorial/bakery/migration.html">Creating A Migration</a></li>
                                    <li><a itemprop="url" href="razor-pages/tutorial/bakery/create-model.html">Working With A Model</a></li>
                                    <li><a itemprop="url" href="razor-pages/routing.html">Routing in Razor Pages</a></li>
                                    <li><a itemprop="url" href="razor-pages/tutorial/bakery/working-with-data.html">Working With Data</a></li>
                                    <li><a itemprop="url" href="razor-pages/tutorial/bakery/new-page.html">Adding a New Page</a></li>
                                    <li><a itemprop="url" href="razor-pages/tutorial/bakery.html">Creating an Application</a></li>
                            </ul>
                        </nav>
                    </div>
                    <div class="skyscraper">
                        
                                <script async src="../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
                            <!-- EF Core Skyscraper -->
                            <ins class="adsbygoogle"
                                 style="display:inline-block;width:300px;height:600px"
                                 data-ad-client="ca-pub-8046723421340367"
                                 data-ad-slot="4239197376"></ins>
                            <script>
                                (adsbygoogle = window.adsbygoogle || []).push({});
                            </script>
                        
                    </div>
                    <footer>
                        <p>&copy; 2019 - Learn Razor Pages.<br />All rights reserved.</p>
                    </footer>
                </div>
            </div>
        </div>
        <a href="#page-top" id="back-to-top" class="page-scroll" title="Back to top"><i class="fas fa-arrow-alt-circle-up"></i></a>
    </div>
    <div class="cookie-box" id="cookie-warning">
        <div class="cookie-box-contents" id="learnrazorpages">This site uses cookies to analyse traffic, remember your preferences, and optimise your experience.</div>
        <div class="cookie-box-buttons"><a href="privacy.html" class="cookie-button">Learn more</a><a href="#" class="cookie-button" id="cookie-close">Close</a></div>
    </div>
    <script src="../ajax.aspnetcdn.com/ajax/jquery/jquery-2.2.0.min.js"></script>
    <script src="../ajax.aspnetcdn.com/ajax/bootstrap/3.3.6/bootstrap.min.js"></script>
    <script src="../code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    
    <script src="../cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
    <script src="js/site59f2.js?v=gJZRD7PDF8oEm1Xb0uhLZcpf7Vs12fGO-q0DErBSF_Y"></script>
    
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-1264020-21"></script>
        <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-1264020-21');
        </script>
    
    
</body>

<!-- Mirrored from www.learnrazorpages.com/startup by HTTrack Website Copier/3.x [XR&CO'2005], Fri, 07 Jun 2019 04:13:08 GMT -->
</html>
